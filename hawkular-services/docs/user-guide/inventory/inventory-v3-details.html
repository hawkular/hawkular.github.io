<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hawkular - Inventory v3: technical details</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- css -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link href="../../../../css/tabzilla.css" rel="stylesheet">
    <link href="../../../../css/styles.css" rel="stylesheet">
    <link href="../../../../css/prettify.css" rel="stylesheet">
    <link href="../../../../css/ekko-lightbox.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
    <script src="../../../../js/moment.min.js"></script>
    <script src="../../../../js/jquery-1.11.2.min.js"></script>

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../../../favicon.ico">
    
  </head>
  <body onload="prettyPrint()" data-spy="scroll" data-offset="80" data-target="#toc">
    <div id="wrap">
      <div class="dropup">
        <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
        <script>
            window.addEventListener('load', function() {
                 renderTabzilla("Hawkular", "https://hawkular.github.io", true );
            }, false);
        </script>
      </div>

    	<!-- Fixed navbar -->
        <nav class="navbar navbar-fixed-top" role="navigation">
          <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li><a href="../../../../overview/">Overview</a></li>
                <li><a href="../../../../blog.html">Blog</a></li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Services<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li class="menu-item dropdown dropdown-submenu">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/quickstart-guide/">Quickstart</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/installation-guide/">Installation Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/user-guide/">User Guide</a>
                        </li>
                        <li class="menu-item dropdown dropdown-submenu">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API</a>
                          <ul class="dropdown-menu">
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-alerts.html">Alerting</a>
                            </li>
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-inventory.html">Inventory</a>
                            </li>
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-metrics.html">Metrics</a>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-services/releases">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular APM<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li>
                      <li><a href="../../../../hawkular-apm/">Overview</a></li>
                    </li>
                    <li>
                      <a href="https://hawkular.gitbooks.io/hawkular-apm-user-guide/content/">Documentation</a>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-apm/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Metrics<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../hawkular-metrics/docs/user-guide/">Metrics User Guide</a>
                        </li>
                        <li class="menu-item ">
                            <a href="../../../../community/docs/developer-guide/alerts.html">Alerting User Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../docs/rest/rest-metrics.html">Metrics REST API</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../docs/rest/rest-alerts.html">Alerting REST API</a>
                        </li>
                      </ul>
                  </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-metrics/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li><a href="../../../../hawkular-clients/">Hawkular Clients</a></li>
                <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                  Community
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../../../../community/docs/getting-involved/">Getting Involved</a>
                  </li>
                  <li class="menu-item ">
                    <a href="../../../../community/docs/developer-guide/">Developer Guide</a>
                  </li>
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Labs</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../community/labs/datamining/">Datamining</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/pilhuhn/hawkfx">HawkFX</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-clients/android-client/">Android client</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/jotak/hawkular-java-toolbox">Client-side java toolbox</a>
                        </li>
                      </ul>
                  </li>
                  <li>
                    <a href="https://github.com/hawkular">GitHub Repositories</a>
                  <li>
                    <a href="https://travis-ci.org/hawkular">CI Builds</a>
                  </li>
                </ul></li>
              </ul>
            </div>
          </div>
        </nav>

      <section class="main-banner">
        <div class="container">
          <h1>Inventory v3: technical details</h1>
          <p></p>
<!-- show tags for this page -->
   <p> 
      <a href="/tags/inventory.html">inventory</a> 
  </p>
        </div>

      </section>

	<!--<p><em>27 April 2017</em></p>-->

	<section>
      <div class="container">
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#_producing_data_hawkular_agents">Producing data (Hawkular Agents)</a>
<ul class="sectlevel2">
<li><a href="#_before">Before</a></li>
<li><a href="#_now">Now</a></li>
<li><a href="#_algorithm">Algorithm</a></li>
</ul>
</li>
<li><a href="#_curl_examples">Curl examples</a>
<ul class="sectlevel2">
<li><a href="#_list_all_feeds">List all feeds</a></li>
<li><a href="#_list_all_resource_types_for_that_feed">List all resource types for that feed</a></li>
<li><a href="#_get_root_resource_local">Get root resource "Local~~"</a></li>
<li><a href="#_get_all_resources_of_type_wildfly_server">Get all resources of type "WildFly Server"</a></li>
</ul>
</li>
<li><a href="#_reading_data">Reading data</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_producing_data_hawkular_agents">Producing data (Hawkular Agents)</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_before">Before</h3>
<div class="paragraph">
<p>Inventories were sent to <code>hawkular/inventory</code> upon discovery or add/remove resource events. In both cases, the whole subtree of the root resource that was modified was synced. Resource types and metric types were synced only once, assuming they never change in the agent lifetime. Hawkular Inventory was responsible for computing hashes and updating whatever was necessary.</p>
</div>
</div>
<div class="sect2">
<h3 id="_now">Now</h3>
<div class="paragraph">
<p>The global algorithm remains almost identical: inventories are sent to <code>hawkular/metrics</code> upon discovery or add/remove resource events, and the whole subtree is serialized as a json blob. Each subtree is entirely updated at once. However now, during discovery, the necessity to perform an update is also related to the TTL expiration, which is anticipated. So, updates could potentially be sent even on non-modified resources and types.</p>
</div>
</div>
<div class="sect2">
<h3 id="_algorithm">Algorithm</h3>
<div class="paragraph">
<p>The serialization process of a given root resource is as follow:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The whole <em>inventory structure</em> object related to that resource is Jsonified. That <em>inventory structure</em> comes from the existing inventory API and hasn&#8217;t been changed. It is however encapsulated into an object that also contains index maps. That will be explained below (<a href="#indexes">section Indexes</a>).</p>
</li>
<li>
<p>It is gzipped</p>
</li>
<li>
<p>It&#8217;s eventually split into chunks of 1536 bytes
<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup>
(contiguous pieces of the byte array)</p>
</li>
<li>
<p>Each piece is converted into a datapoint. The first one uses current timestamp, every following chunk <code>'i'</code> uses <code>'timestamp-i'</code>.</p>
</li>
<li>
<p>If there&#8217;s several chunks, the first one (call it 'master') is associated with a datapoint tag <code>chunks</code> that gives the number of chunks, including itself.</p>
</li>
<li>
<p>Note that, during Json conversion of the datapoint object, the byte array is base64-stringified. It&#8217;s the default behaviour of Jackson for byte[].</p>
</li>
<li>
<p>Datapoints are sent on <code>hawkular/metrics/strings/{metricId}/raw</code>. <code>{metricId}</code> is built after the following pattern:</p>
<div class="ulist">
<ul>
<li>
<p><code>inventory.{feedId}.{type}.{id}</code></p>
</li>
<li>
<p><code>{type}</code> being <code>r</code> in the case of root resources, <code>rt</code> for resource types and <code>mt</code> for metric types.</p>
</li>
<li>
<p><code>{id}</code> being the id of the root resource / resource type / metric type</p>
</li>
<li>
<p>The whole metricId is url-encoded.</p>
</li>
</ul>
</div>
</li>
<li>
<p>The metric is tagged and associated with a data retention of 7 days. Tags are (with same variables as described above):</p>
<div class="ulist">
<ul>
<li>
<p><code>module:inventory</code></p>
</li>
<li>
<p><code>feed:{feedId}</code></p>
</li>
<li>
<p><code>type:{type}</code></p>
</li>
<li>
<p><code>id:{id}</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Root resources are also tagged with resource types and metric types as described below (<a href="#indexes">section Indexes</a>).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The serialization process of resource types and metric types is almost identical, except that there is no associated index maps and no resource types / metric types tags.</p>
</div>
<div class="sect3">
<h4 id="indexes">Indexes</h4>
<div class="paragraph">
<p>Two index maps are added to the json, one for resource types, the other for metric types. They are useful for some common query patterns.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>They&#8217;re in the form of <code>Map&lt;String, Collection&lt;String&gt;&gt;</code>; the map key is the resource/metric type; the collection is the list of relative paths of the elements of that type. So, each resource and metric in the subtree (including the root resource itself) appears in one of the map.</p>
</li>
<li>
<p>These maps are stored in the json blob along with root resources inventory structure. They&#8217;re part of the compressed &amp; chunked data.</p>
</li>
<li>
<p>The map keys are also stored in tags on root resource metrics:</p>
<div class="ulist">
<ul>
<li>
<p><code>restypes:{list of resource types separated with "|"}</code></p>
</li>
<li>
<p><code>mtypes:{list of metric types separated with "|"}</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that, unlike in previous inventory, feeds have no existence by themselves. You cannot explicitly create a feed anymore, you just implicitly create them by associating a feedId to root resources.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_curl_examples">Curl examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_list_all_feeds">List all feeds</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl -u jdoe:password -H 'Hawkular-Tenant: hawkular' http://localhost:8080/hawkular/metrics/strings/tags/module:inventory,feed:*

{"feed":["aa87aba58bf5"],"module":["inventory"]}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_list_all_resource_types_for_that_feed">List all resource types for that feed</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl -u jdoe:password -X POST -H 'Hawkular-Tenant: hawkular' -H 'Content-Type: application/json' -d '{"fromEarliest":"true","order":"DESC","tags":"feed:aa87aba58bf5,type:rt"}' http://localhost:8080/hawkular/metrics/strings/raw/query

[{"id":"inventory.aa87aba58bf5.rt.Message Driven EJB","data":[{"timestamp":1493279847648,"value":"..."}]},{"id":"inventory.aa87aba58bf5.rt.Platform_Memory","data":[{"timestamp":1493279844927,"value":"..."}]},{"id":"inventory.aa87aba58bf5.rt.JMS Topic","data":[{"timestamp":1493279847697,"value":"..."}]},{"id":"inventory.aa87aba58bf5.rt.Socket Binding Group","data":[{"timestamp":1493279847788,"value":"..."}]},{"id":"inventory.aa87aba58bf5.rt.Stateful Session EJB","data":[{"timestamp":1493279847637,"value":"..."}]},(etc.)]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get_root_resource_local">Get root resource "Local~~"</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl -u jdoe:password -X POST -H 'Hawkular-Tenant: hawkular' -H 'Content-Type: application/json' -d '{"fromEarliest":"true","order":"DESC","tags":"feed:aa87aba58bf5,type:r,id:Local~~"}' http://localhost:8080/hawkular/metrics/strings/raw/query

[{"id":"inventory.aa87aba58bf5.r.Local~~","data":[{"timestamp":1493279847975,"value":"...","tags":{"chunks":"9","size":"13488"}},{"timestamp":1493279847974,"value":"..."},{"timestamp":1493279847973,"value":"..."},(etc. til timestamp 1493279847967)]}]</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_get_all_resources_of_type_wildfly_server">Get all resources of type "WildFly Server"</h3>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl -u jdoe:password -X POST -H 'Hawkular-Tenant: hawkular' -H 'Content-Type: application/json' -d '{"fromEarliest":"true","order":"DESC","tags":"feed:aa87aba58bf5,type:r,restypes:.*\\|WildFly Server\\|.*"}' http://localhost:8080/hawkular/metrics/strings/raw/query

[{"id":"inventory.aa87aba58bf5.r.Local~~","data":[{"timestamp":1493279847975,"value":"...","tags":{"chunks":"9","size":"13488"}},{"timestamp":1493279847974,"value":"..."},{"timestamp":1493279847973,"value":"..."},(etc. til timestamp 1493279847967)]}]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Of course here, only the matching root resources are returned. But in each of those, you can quickly access relevant children through resource types index lookup.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reading_data">Reading data</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As now, there&#8217;s two implementations of a "reader" for inventory content, in Java (<a href="https://github.com/hawkular/hawkular-agent/blob/master/hawkular-agent-itest-util/src/main/java/org/hawkular/agent/itest/util/ITestHelper.java">hawkular-agent integration tests</a>)
and in Ruby (<a href="https://github.com/hawkular/hawkular-client-ruby/blob/master/lib/hawkular/inventory/inventory_api.rb">hawkular-client-ruby</a>), one being essentially a translation of the other in another language.</p>
</div>
<div class="paragraph">
<p>Following serialization algorithm in the reverse order, we get:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do some query on <code>@post hawkular/metrics/strings/raw/query</code> with <code>fromEarliest=true</code>, <code>order=DESC</code> and the real query parameters are in <code>tags</code>, as seen above.
The response is an array of metrics, each containing an array of datapoints.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Example of a query that would return two resources; the first is chunked, the second isn&#8217;t:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">[{
  "id":"&lt;first id&gt;",
  "data":[
    {"timestamp":123456789,"value":"&lt;compressed_data_chunk_1&gt;","tags":{"chunks":"&lt;number of chunks&gt;","size":"total_size_of_chunks_in_bytes"}},
    {"timestamp":123456788,"value":"&lt;compressed_data_chunk_2&gt;"},
    {"timestamp":123456787,"value":"&lt;compressed_data_chunk_3&gt;"},
    // etc.
  ]
},{
  "id":"&lt;second id&gt;",
  "data":[
    {"timestamp":123456789,"value":"&lt;compressed_data_without_chunk&gt;"}
  ]
}]</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>For each returned item <code>response[i].data</code>:</p>
<div class="ulist">
<ul>
<li>
<p>Take the first datapoint, get its tag <code>chunks</code> if any; if there isn&#8217;t we can consider there&#8217;s 1 chunk.</p>
</li>
<li>
<p>Note that it is important to rely on that datapoint tag and not read every datapoints, because if the resource has been updated you would get more datapoints than necessary.</p>
</li>
<li>
<p>If the language allows, we can pre-allocate a byte array: the tag <code>size</code> gives the total byte size.</p>
</li>
<li>
<p>For each chunk to read, base64-decode it to bytes and concatenate with the previous.</p>
</li>
<li>
<p>Un-gzip the result.</p>
</li>
<li>
<p>Parse as json.</p>
</li>
</ul>
</div>
</li>
<li>
<p>So now you should have an array of <em>inventory structures</em> with their associated index maps. Something like:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">{
  "inventoryStructure": {
    "type": "resource",
    "data": {
      "properties": {},
      "id": "Local~~",
      "name": "WildFly Server [Local]",
      "outgoing": {},
      "incoming": {},
      "resourceTypePath": "/t;hawkular/f;aa87aba58bf5/rt;WildFly%20Server"
    },
    "children": {
      "metric": [
        {
          "data": {
            "properties": {},
            "id": "AI~R~[aa87aba58bf5/Local~~]~AT~Server Availability~Server Availability",
            "name": "Server Availability",
            "outgoing": {},
            "incoming": {},
            "metricTypePath": "/t;hawkular/f;aa87aba58bf5/mt;Server%20Availability~Server%20Availability",
            "collectionInterval": null
          },
          "children": {}
        }
      ],
      "resource": [
        {
          "data": {
            "properties": {},
            "id": "Local~/deployment=hawkular-command-gateway-war.war",
            "name": "Deployment [hawkular-command-gateway-war.war]",
            "outgoing": {},
            "incoming": {},
            "resourceTypePath": "/t;hawkular/f;aa87aba58bf5/rt;Deployment"
          },
          "children": {
            "metric": [
              {
                "data": {
                  "properties": {},
                  "id": "AI~R~[aa87aba58bf5/Local~/deployment=hawkular-command-gateway-war.war]~AT~Deployment Status~Deployment Status",
                  "name": "Deployment Status",
                  "outgoing": {},
                  "incoming": {},
                  "metricTypePath": "/t;hawkular/f;aa87aba58bf5/mt;Deployment%20Status~Deployment%20Status",
                  "collectionInterval": null
                },
                "children": {}
              }
            ]
          }
        }
      ],
      "dataEntity": [
        {
          "data": {
            "properties": {},
            "id": "configuration",
            "name": null,
            "outgoing": {},
            "incoming": {},
            "value": {
              "Immutable": "true",
              "Bound Address": "0.0.0.0",
              "Home Directory": "/opt/jboss/wildfly",
              "Node Name": "aa87aba58bf5",
              "Server State": "running",
              "Product Name": "Hawkular",
              "Hostname": "aa87aba58bf5",
              "In Container": "true",
              "Name": "aa87aba58bf5",
              "Suspend State": "RUNNING",
              "Running Mode": "NORMAL",
              "Version": "0.36.0.Final",
              "UUID": "03eca767-e48f-4f0b-9a8a-d8f46112c9a5"
            },
            "role": "configuration"
          },
          "children": {}
        }
      ]
    }
  },
  "typesIndex": {
    "Deployment": [
      "r;Local~%2Fdeployment%3Dhawkular-command-gateway-war.war"
    ],
    "WildFly Server": [
      ""
    ]
  },
  "metricTypesIndex": {
    "Deployment Status~Deployment Status": [
      "r;Local~%2Fdeployment%3Dhawkular-command-gateway-war.war/m;AI~R~%5Baa87aba58bf5%2FLocal~%2Fdeployment%3Dhawkular-command-gateway-war.war%5D~AT~Deployment%20Status~Deployment%20Status"
    ],
    "Server Availability~Server Availability": [
      "m;AI~R~%5Baa87aba58bf5%2FLocal~~%5D~AT~Server%20Availability~Server%20Availability"
    ]
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><em>Note: this is a drastically shortened example of Json taken from what we get when starting hawkular-services. Full Json dumped here:</em>
<em><a href="/data/docs/inventory/inventory-v3-full-example.json">full-example.json</a></em></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Now to exploit this structure, for instance if you were looking for a specific canonical path, you go down in the tree children following your path.</p>
</li>
<li>
<p>If you were querying against one of the index, for instance "all resources of type 'Deployment'", the <code>typesIndex</code> key in json will give you all associated relative paths that you can find in the subtree. Just parse it and go down through it. In Java, the CanonicalPath class, from existing inventory API, is still very helpful here for parsing and going down (it&#8217;s in hawkular-commons). It has been kind of ported in the ruby client in a simpler way but sufficiant for what we need.</p>
</li>
</ul>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. The byte array being base64-encoded, the resulting String max size must be less than 2048 (max string metrics size in Hawkular metrics) and 1536 = 2048 * 3 / 4, due to base64 4:3 overhead ratio.
</div>
</div>
      </div>
    </section>

		</div>
		<div id="push"></div>
    </div>

    <section class="redhat clearfix">
      <div class="container">
        <p class="pull-left">
          <a href="http://www.redhat.com/">
            <img alt="redhatlogo-white" src="../../../..//img/redhatlogo-white.png" width="130">
          </a>
        </p>
        <p class="muted credit pull-right">
				  &copy; 2016 | Hawkular is released under <a href="/license.html">Apache License v2.0</a>
					<a href="https://twitter.com/hawkular_org" class="twitter-follow-button" data-show-count="false" data-size="medium">Follow @hawkular_org</a>
				  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
					<iframe src="https://ghbtns.com/github-btn.html?user=hawkular&repo=hawkular-services&type=star" frameborder="0" scrolling="0" class="github-stars-btn"></iframe>
				</p>

    <!--p id="forkongithubp"><span id="forkongithub">
      <a href="https://github.com/hawkular" class="bg-grey">
        Fork me on GitHub
      </a>
    </span></p-->
      </div>
    </section>

    <!-- javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- js -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="../../../../js/jbossorg-tabzilla.js"></script>
    <script src="../../../../js/behavior.js"></script>
    <script src="../../../../js/prettify.js"></script>
    <script src="../../../../js//ekko-lightbox.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'hawkular';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61728352-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
