<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hawkular - Distributed Tracing with Apache Camel and OpenTracing</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- css -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../../../css/base.css" rel="stylesheet">
    <link href="../../../../css/tabzilla.css" rel="stylesheet">
    <link href="../../../../css/styles.css" rel="stylesheet">
    <link href="../../../../css/prettify.css" rel="stylesheet">
    <link href="../../../../css/ekko-lightbox.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../../../js/html5shiv.min.js"></script>
    <![endif]-->
    <script src="../../../../js/moment.min.js"></script>
    <script src="../../../../js/jquery-1.11.2.min.js"></script>

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../../../favicon.ico">
    
  </head>
  <body onload="prettyPrint()" data-spy="scroll" data-offset="80" data-target="#toc">
    <div id="wrap">
      <div class="dropup">
        <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
        <script>
            window.addEventListener('load', function() {
                 renderTabzilla("Hawkular", "https://hawkular.github.io", true );
            }, false);
        </script>
      </div>
	
    	<!-- Fixed navbar -->
        <nav class="navbar navbar-fixed-top" role="navigation">
          <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../../../">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li><a href="../../../../overview/">Overview</a></li>
                <li><a href="../../../../blog.html">Blog</a></li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Services<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li class="menu-item dropdown dropdown-submenu">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/quickstart-guide/">Quickstart</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/installation-guide/">Installation Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-services/docs/user-guide/">User Guide</a>
                        </li>
                        <li class="menu-item dropdown dropdown-submenu">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API</a>
                          <ul class="dropdown-menu">
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-alerts.html">Alerting</a>
                            </li>
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-inventory.html">Inventory</a>
                            </li>
                            <li class="menu-item ">
                              <a href="../../../../docs/rest/rest-metrics.html">Metrics</a>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-services/releases">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular APM<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li>
                      <li><a href="../../../../hawkular-apm/">Overview</a></li>
                    </li>
                    <li>
                      <a href="https://hawkular.gitbooks.io/hawkular-apm-user-guide/content/">Documentation</a>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-apm/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Metrics<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../hawkular-metrics/docs/user-guide/">Metrics User Guide</a>
                        </li>
                        <li class="menu-item ">
                            <a href="../../../../community/docs/developer-guide/alerts-v1.html">Alerting User Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../docs/rest/rest-metrics.html">Metrics REST API</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../docs/rest/rest-alerts-v1.html">Alerting REST API</a>
                        </li>
                      </ul>
                  </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-metrics/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Alerting<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item dropdown dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Alerting User Guide</a>
                            <ul class="dropdown-menu">
                              <li class="menu-item ">
                                <a href="../../../../community/docs/developer-guide/alerts-v1.html">Version 1</a>
                              </li>
                              <li class="menu-item ">
                                <a href="../../../../community/docs/developer-guide/alerts-v2.html">Version 2</a>
                              </li>
                            </ul>
                        </li>
                        <li class="menu-item dropdown dropdown-submenu">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Alerting REST API</a>
                            <ul class="dropdown-menu">
                              <li class="menu-item ">
                                <a href="../../../../docs/rest/rest-alerts-v1.html">Version 1</a>
                              </li>
                              <li class="menu-item ">
                                <a href="../../../../docs/rest/rest-alerts-v2.html">Version 2</a>
                              </li>
                            </ul>
                        </li>
                      </ul>
                  </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-alerts/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li><a href="../../../../hawkular-clients/">Hawkular Clients</a></li>
                <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                  Community
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="../../../../community/docs/getting-involved/">Getting Involved</a>
                  </li>
                  <li class="menu-item ">
                    <a href="../../../../community/docs/developer-guide/">Developer Guide</a>
                  </li>
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Labs</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="../../../../community/labs/datamining/">Datamining</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/pilhuhn/hawkfx">HawkFX</a>
                        </li>
                        <li class="menu-item ">
                          <a href="../../../../hawkular-clients/android-client/">Android client</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/jotak/hawkular-java-toolbox">Client-side java toolbox</a>
                        </li>
                      </ul>
                  </li>
                  <li>
                    <a href="https://github.com/hawkular">GitHub Repositories</a>
                  <li>
                    <a href="https://travis-ci.org/hawkular">CI Builds</a>
                  </li>
                </ul></li>
              </ul>
            </div>
          </div>
        </nav>

    <section class="main-banner blog-mainbanner">
        <div class="container">
            <h1>Distributed Tracing with Apache Camel and OpenTracing</h1>
            <p>A blog post by Gary Brown</p>
<!-- show tags for this page -->
   <p> 
      <a href="/tags/apache camel.html">apache camel</a> 
          |
      <a href="/tags/apm.html">apm</a> 
          |
      <a href="/tags/opentracing.html">opentracing</a> 
  </p>
        </div>
    </section>

    <div class="blog-container">
        <br/><br/>
    	<p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In this post we will discuss how the <a href="http://opentracing.io/">OpenTracing standard</a> is being supported in the upcoming release of Apache Camel (version 2.19).</p>
</div>
<div class="paragraph">
<p>OpenTracing is the vendor neutral open standard for distributed tracing, supported across many languages and with a growing number of tracer implementations and framework integrations. To illustrate the vendor neutrality, we will demonstrate two examples, each using a different OpenTracing compliant Tracer.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-03-24-camel-loanbroker-jms-instance.png" alt="2017 03 24 camel loanbroker jms instance">
</div>
<div class="title">Figure 1: Distributed trace for the Camel Loan Broker JMS example</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_instrument_a_camel_application">How to Instrument a Camel Application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first thing to note is that it is not necessary to modify the Camel routes to have them instrumented using an OpenTracing compliant Tracer. The only requirement is to add some relevant dependencies and initialize the tracer on the <code>CamelContext</code>.</p>
</div>
<div class="paragraph">
<p>This can be achieved in three ways:</p>
</div>
<div class="sect2">
<h3 id="_explicit_initialization">Explicit initialization</h3>
<div class="paragraph">
<p>The dependencies required to explicitly initialize OpenTracing are</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-opentracing&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>and any other dependencies specific to the OpenTracing compliant Tracer implementation being used.</p>
</div>
<div class="paragraph">
<p>Then either add the initialization of the tracer to the Spring configuration,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">  &lt;bean id="tracer" class="..."/&gt;

  &lt;bean id="ottracer" class="org.apache.camel.opentracing.OpenTracingTracer"&gt;
    &lt;property name="tracer" ref="tracer"/&gt;
  &lt;/bean&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or create an observer on the <code>CamelContextStartingEvent</code> to trigger the initialization of the tracer,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@ContextName("....")
public class MyApplication {
    public void setupCamel(@Observes CamelContextStartingEvent event) {
	// Location for initializing the Tracer if not implicitly loaded
        OpenTracingTracer ottracer = new OpenTracingTracer();
        ottracer.init(event.getContext());
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/apache/camel/tree/master/examples/camel-example-opentracing/client">camel-opentracing example client application</a> for an example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_spring_boot_annotation">Spring Boot Annotation</h3>
<div class="paragraph">
<p>The dependencies required to use OpenTracing in a Spring Boot application are simply</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-opentracing-starter&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>and any other dependencies specific to the OpenTracing compliant Tracer implementation being used. Then simply annotate the application using <code>CamelOpenTracing</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@SpringBootApplication
@CamelOpenTracing
public class MyApplication {
    public static void main(String[] args) {
	// Location for initializing the Tracer if not implicitly loaded
        SpringApplication.run(MyApplication.class, args);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/apache/camel/tree/master/examples/camel-example-opentracing/service1">camel-opentracing example service1 application</a> for an example.</p>
</div>
</div>
<div class="sect2">
<h3 id="_java_agent">Java Agent</h3>
<div class="paragraph">
<p>This approach uses a <code>javaagent</code> to handle the initialization, so does not require any code/configuration changes. The dependencies required are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;org.apache.camel&lt;/groupId&gt;
      &lt;artifactId&gt;camel-opentracing&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.opentracing.contrib&lt;/groupId&gt;
      &lt;artifactId&gt;opentracing-agent&lt;/artifactId&gt;
      &lt;scope&gt;provided&lt;/scope&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Changes are also required in the <code>pom.xml</code> to download the <code>opentracing-agent.jar</code> and then execute the application supplying the java agent on the command line.</p>
</div>
<div class="paragraph">
<p>See the <a href="https://github.com/apache/camel/tree/master/examples/camel-example-opentracing/service2">camel-opentracing example service2 application</a> for an example.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instrumenting_some_examples">Instrumenting Some Examples</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section will show how two examples can be instrumented using two different OpenTracing compliant Tracer implementations.</p>
</div>
<div class="paragraph">
<p>The first is a new example introduced to demonstrate the three ways a Camel application can be instrumented with OpenTracing, and will be updated to use the <a href="http://zipkin.io/">Zipkin</a> project.</p>
</div>
<div class="paragraph">
<p>The second shows how an existing example (Loan Broker JMS) can be instrumented using the <a href="http://www.hawkular.org/hawkular-apm/">Hawkular APM</a> project.</p>
</div>
<div class="sect2">
<h3 id="_camel_opentracing_example">Camel OpenTracing Example</h3>
<div class="paragraph">
<p>This section will show how the new example, which uses a simple <em>logging</em> tracer implementation by default, can be changed to use Zipkin.</p>
</div>
<div class="paragraph">
<p>First edit each of the client/service1/service2 <code>pom.xml</code> files to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add properties</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">  &lt;properties&gt;
    ...
    &lt;version.brave.opentracing&gt;0.19.0&lt;/version.brave.opentracing&gt;
    &lt;version.zipkin.reporter&gt;0.6.13&lt;/version.zipkin.reporter&gt;
  &lt;/properties&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Replace the <code>camel-example-opentracing-loggingtracer</code> dependency with:</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.opentracing.brave&lt;/groupId&gt;
      &lt;artifactId&gt;brave-opentracing&lt;/artifactId&gt;
      &lt;version&gt;${version.brave.opentracing}&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.zipkin.reporter&lt;/groupId&gt;
      &lt;artifactId&gt;zipkin-sender-urlconnection&lt;/artifactId&gt;
      &lt;version&gt;${version.zipkin.reporter}&lt;/version&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then the following Java code changes are required:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Common code for ClientApplication, Service1Application and Service2Application</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">import brave.opentracing.BraveTracer;
import io.opentracing.Tracer;
import zipkin.Span;
import zipkin.reporter.AsyncReporter;
import zipkin.reporter.Reporter;
import zipkin.reporter.urlconnection.URLConnectionSender;

....
    public static Tracer initTracer() {
        System.out.println("Using Zipkin Tracer");
        String zipkinServerUrl = String.format("%s/api/v1/spans", System.getenv("ZIPKIN_SERVER_URL"));
        Reporter&lt;Span&gt; reporter = AsyncReporter.builder(URLConnectionSender.create(zipkinServerUrl)).build();
        brave.Tracer tracer = brave.Tracer.newBuilder().localServiceName("SERVICE_NAME").reporter(reporter).build();
        return BraveTracer.wrap(tracer);
    }</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Don&#8217;t forget to change the <code>SERVICE_NAME</code> to something appropriate (e.g. client, service1 and service2 respectively).
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>In <code>ClientApplication.java</code> add <code>ottracer.setTracer(initTracer())</code>, e.g.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">        OpenTracingTracer ottracer = new OpenTracingTracer();
        ottracer.setTracer(initTracer());</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>In <code>Service1Application.java</code>, simply add the <code>@Bean</code> annotation above the <code>initTracer()</code> method.</p>
</li>
<li>
<p>In <code>Service2Application.java</code>, add the tracer from <code>initTracer()</code> to the registry, e.g.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">        Main main = new Main();
        main.bind("tracer", initTracer());</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the changes have all been made, compile the example using <code>mvn compile</code> from the <code>examples/camel-example-opentracing</code> folder. Next step is to start the Zipkin server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run -p 9411:9411 openzipkin/zipkin</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then follow the instructions in the README.md for running the three applications. Before running each command, you will need to run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">export ZIPKIN_SERVER_URL=http://localhost:9411</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the example has executed, start up the <a href="http://localhost:9411/">Zipkin UI</a> in a brower. Select the <code>client</code> service and you should see some traces:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-03-24-camel-opentracing-example-zipkin.png" alt="2017 03 24 camel opentracing example zipkin">
</div>
<div class="title">Figure 2: Zipkin trace instance showing communication between client, service1 and service2</div>
</div>
</div>
<div class="sect2">
<h3 id="_camel_loan_broker_jms_example">Camel Loan Broker JMS Example</h3>
<div class="paragraph">
<p>The standard example can be found in <code>examples/camel-example-loan-broker-jms</code> folder within the Apache Camel source code. To enable tracing, against the Hawkular APM server, you need to edit the <code>pom.xml</code> based on the
<a href="/data/blog/2017/2017-03-24-loanbroker-apm.patch">differences shown here</a>
. This patch file can be used to quickly update the example.</p>
</div>
<div class="paragraph">
<p>These differences can be broken down into three main changes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Added dependencies, including the <code>camel-opentracing</code> component, <code>opentracing-agent</code> and <code>hawkular-apm</code> (OpenTracing client and REST client publisher)</p>
</li>
<li>
<p>Retrieval of the <code>opentracing-agent.jar</code>, which is placed in a local <code>lib</code> folder for subsequent use</p>
</li>
<li>
<p>Changes to the <code>exec-maven-plugin</code> configuration to enable the services to be started with the <code>opentracing-agent.jar</code> (using <code>mvn exec:exec</code> instead of <code>mvn exec:java</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To try out the example, it is first necessary to start the Hawkular APM server:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run -p 8180:8080 jboss/hawkular-apm-server-dev</code></pre>
</div>
</div>
<div class="paragraph">
<p>The next step is to open up two command windows and setup the environment variables in each:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">export HAWKULAR_APM_USERNAME=admin
export HAWKULAR_APM_PASSWORD=password
export HAWKULAR_APM_URI=http://localhost:8180</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then run the following in the first window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">mvn compile
mvn exec:java -PQueue.LoanBroker</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once fully started, then run the following in the second window:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">mvn exec:java -PQueue.Client</code></pre>
</div>
</div>
<div class="paragraph">
<p>After the client has finished, open a <a href="http://localhost:8180">browser window</a> and log in using username <code>admin</code> password <code>password</code>, and view the <em>Distributed Tracing</em> page to view the dependencies between the JMS endpoints:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-03-24-camel-loanbroker-jms-dependencies.png" alt="2017 03 24 camel loanbroker jms dependencies">
</div>
<div class="title">Figure 3: Service endpoint dependencies for the loan broker JMS example</div>
</div>
<div class="paragraph">
<p>Selecting the <em>Show 1 Instance(s) Details</em> button will show the trace instance shown in Figure 1 above.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_summary">Summary</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This post has shown how OpenTracing can be used to provide distributed tracing capabilities for Camel applications. This capability will be introduced in version 2.19 of Apache Camel, but we would encourage anyone interested in this functionality to obtain a snapshot version to try it out. If you find any issues, or would like additional capabilities prior to the release, then please <a href="http://www.hawkular.org/community/docs/getting-involved/">get in touch</a>.</p>
</div>
<div class="paragraph">
<p>For any Apache Camel users currently using the <code>camel-zipkin</code> component we would encourage you to try out the new <code>camel-opentracing</code> component with the <code>brave-opentracing</code> bridge.</p>
</div>
</div>
</div></p>
    	<hr /><br /><br />

        <p><em>Published by Gary Brown on  24 March 2017</em></p>

    <div id="disqus_thread"></div>
        <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES * * */
        var disqus_shortname = 'hawkular';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
    </div>

		</div>
		<div id="push"></div>
    </div>

    <section class="redhat clearfix">
      <div class="container">
        <p class="pull-left">
          <a href="http://www.redhat.com/">
            <img alt="redhatlogo-white" src="../../../..//img/redhatlogo-white.png" width="130">
          </a>
        </p>
        <p class="muted credit pull-right">
				  &copy; 2016 | Hawkular is released under <a href="/license.html">Apache License v2.0</a>
					<a href="https://twitter.com/hawkular_org" class="twitter-follow-button" data-show-count="false" data-size="medium">Follow @hawkular_org</a>
				  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
					<iframe src="https://ghbtns.com/github-btn.html?user=hawkular&repo=hawkular-services&type=star" frameborder="0" scrolling="0" class="github-stars-btn"></iframe>
				</p>

    <!--p id="forkongithubp"><span id="forkongithub">
      <a href="https://github.com/hawkular" class="bg-grey">
        Fork me on GitHub
      </a>
    </span></p-->
      </div>
    </section>

    <!-- javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- js -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="../../../../js/jbossorg-tabzilla.js"></script>
    <script src="../../../../js/behavior.js"></script>
    <script src="../../../../js/prettify.js"></script>
    <script src="../../../../js//ekko-lightbox.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'hawkular';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61728352-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
