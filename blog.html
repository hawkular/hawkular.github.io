<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Hawkular</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">
    <meta name="generator" content="JBake">

    <!-- css -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/asciidoctor.css" rel="stylesheet">
    <link href="css/base.css" rel="stylesheet">
    <link href="css/tabzilla.css" rel="stylesheet">
    <link href="css/styles.css" rel="stylesheet">
    <link href="css/prettify.css" rel="stylesheet">
    <link href="css/ekko-lightbox.min.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.min.js"></script>
    <![endif]-->
    <script src="js/moment.min.js"></script>
    <script src="js/jquery-1.11.2.min.js"></script>

    <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="alternate" href="feed.xml" title="Hawkular Blog - RSS" type="application/rss+xml">

  </head>
  <body onload="prettyPrint()" data-spy="scroll" data-offset="80" data-target="#toc">
    <div id="wrap">
      <div class="dropup">
        <a class="tabnav-closed" href="#" id="tab">Red Hat</a>
        <script>
            window.addEventListener('load', function() {
                 renderTabzilla("Hawkular", "https://hawkular.github.io", true );
            }, false);
        </script>
      </div>

    	<!-- Fixed navbar -->
        <nav class="navbar navbar-fixed-top" role="navigation">
          <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
              <button class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="">Home</a>
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
              <ul class="nav navbar-nav">
                <li><a href="overview/">Overview</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Services<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li class="menu-item dropdown dropdown-submenu">
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="hawkular-services/docs/quickstart-guide/">Quickstart</a>
                        </li>
                        <li class="menu-item ">
                          <a href="hawkular-services/docs/installation-guide/">Installation Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="hawkular-services/docs/user-guide/">User Guide</a>
                        </li>
                        <li class="menu-item dropdown dropdown-submenu">
                          <a href="#" class="dropdown-toggle" data-toggle="dropdown">REST API</a>
                          <ul class="dropdown-menu">
                            <li class="menu-item ">
                              <a href="docs/rest/rest-alerts.html">Alerting</a>
                            </li>
                            <li class="menu-item ">
                              <a href="docs/rest/rest-inventory.html">Inventory</a>
                            </li>
                            <li class="menu-item ">
                              <a href="docs/rest/rest-metrics.html">Metrics</a>
                            </li>
                          </ul>
                        </li>
                      </ul>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-services/releases">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular APM<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                    <li>
                      <li><a href="hawkular-apm/">Overview</a></li>
                    </li>
                    <li>
                      <a href="https://hawkular.gitbooks.io/hawkular-apm-user-guide/content/">Documentation</a>
                    </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-apm/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li class="dropdown">
                  <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                    Hawkular Metrics<span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu" role="menu">
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="hawkular-metrics/docs/user-guide/">Metrics User Guide</a>
                        </li>
                        <li class="menu-item ">
                            <a href="community/docs/developer-guide/alerts.html">Alerting User Guide</a>
                        </li>
                        <li class="menu-item ">
                          <a href="docs/rest/rest-metrics.html">Metrics REST API</a>
                        </li>
                        <li class="menu-item ">
                          <a href="docs/rest/rest-alerts.html">Alerting REST API</a>
                        </li>
                      </ul>
                  </li>
                    <li>
                      <a href="https://github.com/hawkular/hawkular-metrics/releases/">Download</a>
                    </li>
                  </ul>
                </li>
                <li><a href="hawkular-clients/">Hawkular Clients</a></li>
                <li class="dropdown"><a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button">
                  Community
                  <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" role="menu">
                  <li>
                    <a href="community/docs/getting-involved/">Getting Involved</a>
                  </li>
                  <li class="menu-item ">
                    <a href="community/docs/developer-guide/">Developer Guide</a>
                  </li>
                  <li class="menu-item dropdown dropdown-submenu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Labs</a>
                      <ul class="dropdown-menu">
                        <li class="menu-item ">
                          <a href="community/labs/datamining/">Datamining</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/pilhuhn/hawkfx">HawkFX</a>
                        </li>
                        <li class="menu-item ">
                          <a href="hawkular-clients/android-client/">Android client</a>
                        </li>
                        <li class="menu-item ">
                          <a href="https://github.com/jotak/hawkular-java-toolbox">Client-side java toolbox</a>
                        </li>
                      </ul>
                  </li>
                  <li>
                    <a href="https://github.com/hawkular">GitHub Repositories</a>
                  <li>
                    <a href="https://travis-ci.org/hawkular">CI Builds</a>
                  </li>
                </ul></li>
              </ul>
            </div>
          </div>
        </nav>


<section class="main-banner blog-mainbanner">
    <div class="container">
        <h1>Hawkular Blog</h1>
    </div>
</section>


<div class="blog-container">
            <a href="blog/2017/08/alerts-multiple-sources.html"><h1>Hawkular Alerts with Prometheus, ElasticSearch, Kafka</h1></a>
            <p>11 August 2017, by John Mazzitelli</p>
            <p><div class="sect1">
<h2 id="_federated_alerts">Federated Alerts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Alerts aims to be a federated alerting system. That is to say, it can fire alerts and send notifications that are triggered by data coming from a number of third-party external systems.</p>
</div>
<div class="paragraph">
<p>Thus, Hawkular Alerts is more than just an alerting system for use with Hawkular Metrics. In fact, Hawkular Alerts can be used independently of Hawkular Metrics. This means you do not even have to be using Hawkular Metrics to take advantage of the functionality provided by Hawkular Alerts.</p>
</div>
<div class="paragraph">
<p>This is a key differentiator between Hawkular Alerts and other alerting systems. Most alerting systems only alert on data coming from their respective storage systems (e.g. the Prometheus Alert Engine alerts only on Prometheus data). Hawkular Alerts, on the other hand, can trigger alerts based on data from various systems.</p>
</div>
<div class="sect2">
<h3 id="_alerts_vs_events">Alerts vs. Events</h3>
<div class="paragraph">
<p>Before we begin, a quick clarification is in order. When it is said that Hawkular Alerts fires an "alert" it means some data came into Hawkular Alerts that matched some conditions which triggered the creation of an alert in Hawkular Alerts backend storage (which can then trigger additional actions such as sending emails or calling a webhook). An "alert" typically refers to a problem that has been detected, and someone should take action to fix it. An alert has a lifecycle attached to it - alerts are <em>opened</em>, then <em>acknowledged</em> by some user who will hopefully fix the problem, then <em>resolved</em> when the problem can be considered closed.</p>
</div>
<div class="paragraph">
<p>However, there can be conditions that occur that do not represent problems but nevertheless are events you want recorded. There is no lifecycle associated with events and no additional actions are triggered by events, but "events" are fired by Hawkular Alerts in the same general manner as "alerts" are.</p>
</div>
<div class="paragraph">
<p>In this document, when it is said that Hawkular Alerts can fire "alerts" based on data coming from external third-party systems such as Prometheus, ElasticSearch, and Kakfa, this also means events can be fired as well as alerts. What this means is you can record any event (not just a "problem", aka "alert") that can be gleaned from this data coming from external third-party systems.</p>
</div>
<div class="paragraph">
<p>See <a href="http://www.hawkular.org/community/docs/developer-guide/alerts.html#_alerting_philosophy">alerting philosophy</a> for more.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demo">Demo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is a <a href="https://youtu.be/mM1mwJneKO4">recorded demo found here</a> that will illustrate what this document is describing. After you read this document, you should watch the demo to gain further clarity on what is being explained. The demo is the <code>multiple-sources</code> example which you can run yourself found <a href="https://github.com/hawkular/hawkular-alerts/tree/master/examples/multiple-sources">here</a> (note: at the time of writing, this example is only found in the <a href="https://github.com/hawkular/hawkular-alerts/tree/next/examples/multiple-sources">next branch</a>, to be merged in master soon).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_prometheus">Prometheus</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Alerts can take the results of Prometheus metric queries and use the queried data for triggers that can fire alerts.</p>
</div>
<div class="paragraph">
<p>This Hawkular Alerts trigger will fire an alert (and send an email) when a Prometheus metric indicates our store&#8217;s inventory of widgets is consistently low (as defined by the Prometheus query you see in the "expression" field of the condition):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">"trigger":{
   "id": "low-stock-prometheus-trigger",
   "name": "Low Stock",
   "description": "The number of widgets in stock is consistently low.",
   "severity": "MEDIUM",
   "enabled": true,
   "tags": {
      "prometheus": "Prometheus"
   },
   "actions":[
      {
      "actionPlugin": "email",
      "actionId": "email-notify-owner"
      }
   ]
},
"conditions":[
   {
      "type": "EXTERNAL",
      "alerterId": "prometheus",
      "dataId": "prometheus-dataid",
      "expression": "rate(products_in_inventory{product=\"widget\"}[30s])&lt;2"
   }
]</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_integration_with_prometheus_alert_engine">Integration with Prometheus Alert Engine</h3>
<div class="paragraph">
<p>As a side note, though not demostrated in the example, Hawkular Alerts also has an integration with Prometheus' own Alert Engine. This means the alerts generated by Prometheus itself can be forward to Hawkular Alerts which can, in turn, be used for additional processing, perhaps for use with data that is unavailable to Prometheus that can tell Hawkular Alerts to fire other alerts. For example, Hawkular Alerts can take Prometheus alerts as input and feed it back into other conditions that trigger on the Prometheus alert along with ElasticSearch logs.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_elasticsearch">ElasticSearch</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Alerts can examine logs stored in ElasticSearch and trigger alerts based on patterns that match within the ElasticSearch log messages.</p>
</div>
<div class="paragraph">
<p>This Hawkular Alerts trigger will fire an alert (and send an email) when ElasticSearch logs indicate sales are being lost due to inventory being out of stock of items (as defined by the condition which looks for a log category of "FATAL" which happens to mean a lost sale in the case of the store&#8217;s logs). Notice dampening is enabled on this trigger - this alert will only fire when the logs indicate lost sales every 3 times.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">"trigger":{
   "id": "lost-sale-elasticsearch-trigger",
   "name": "Lost Sale",
   "description": "A sale was lost due to inventory out of stock.",
   "severity": "CRITICAL",
   "enabled": true,
   "tags": {
      "Elasticsearch": "Localhost instance"
   },
   "context": {
      "timestamp": "@timestamp",
      "filter": "{\"match\":{\"category\":\"inventory\"}}",
      "interval": "10s",
      "index": "store",
      "mapping": "level:category,@timestamp:ctime,message:text,category:dataId,index:tags"
   },
   "actions":[
      {
      "actionPlugin": "email",
      "actionId": "email-notify-owner"
      }
   ]
},
"dampenings": [
   {
      "triggerMode": "FIRING",
      "type":"STRICT",
      "evalTrueSetting": 3
   }
],
"conditions":[
   {
      "type": "EVENT",
      "dataId": "inventory",
      "expression": "category == 'FATAL'"
   }
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kafka">Kafka</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hawkular Alerts can examine data retrieved from Kafka message streams and trigger alerts based that Kafka data.</p>
</div>
<div class="paragraph">
<p>This Hawkular Alerts trigger will fire an alert when data over a Kakfa topic indicates a large purchase was made to fill the store&#8217;s inventory (as defined by the condition which evaluates to true when any number over 17 is received on the Kafka topic):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">"trigger":{
   "id": "large-inventory-purchase-kafka-trigger",
   "name": "Large Inventory Purchase",
   "description": "A large purchase was made to restock inventory.",
   "severity": "LOW",
   "enabled": true,
   "tags": {
      "Kafka": "Localhost instance"
   },
   "context": {
      "topic": "store",
      "kafka.bootstrap.servers": "localhost:9092",
      "kafka.group.id": "hawkular-alerting"
   },
   "actions":[ ]
},
"conditions":[
   {
      "type": "THRESHOLD",
      "dataId": "store",
      "operator": "GT",
      "threshold": 17
   }
]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_but_wait_there_s_more">But, Wait! There&#8217;s More!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The above only mentions the different ways Hawkular Metrics retrieves data for use in determining what alerts to fire. What is not covered here is the fact that Hawkular Alerts can stream data in the other direction as well - Hawkular Alerts can send alert and event data <em>to</em> things like an ElasticSearch server or a Kafka broker. There are additional examples (mentioned below) that can demonstrate this capability.</p>
</div>
<div class="paragraph">
<p>The point is Hawkular Alerts should be seen as a shared, common alerting engine that can be shared for use by multiple third-party systems and can be used as both a consumer and producer - as a consumer of the data from external third-party systems (which is used to fire alerts and events) and as a producer to send notifications of alerts and events to external third-party systems.</p>
</div>
<div class="sect2">
<h3 id="_more_examples">More Examples</h3>
<div class="paragraph">
<p>Take a look at the Hawkular Alerts <a href="https://github.com/hawkular/hawkular-alerts/tree/master/examples">examples</a> for more examples on using external systems as data to be used for triggering alerts. (note: at the time of writing, some examples are currently in the <a href="https://github.com/hawkular/hawkular-alerts/tree/next/examples">next branch</a> such as the Kafka ones).</p>
</div>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2017/07/opentracing-ejb.html"><h1>OpenTracing EJB instrumentation</h1></a>
            <p>28 July 2017, by Juraci Paixão Kröhling</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>OpenTracing features more and more framework integrations, allowing for transparent instrumentation
of applications with minimal effort. This blog post will show how to use the EJB instrumentation
to automatically trace EJB invocations.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-07-28-teaser.png" alt="Jaeger with EJB traces">
</div>
</div>
<div class="paragraph">
<p>For this demo, we&#8217;ll generate a project using the Wildfly Swarm project generator, which allows us to
have a seed project with the appropriate OpenTracing support in place. The concrete OpenTracing solution
we will use is provided by the <a href="https://uber.github.io/jaeger/">Jaeger project</a>, which is also
provided as a Wildfly Swarm Fraction.</p>
</div>
<div class="paragraph">
<p>With that, we&#8217;ll create a simple JAX-RS endpoint with an EJB facet, invoking a set of EJB services in
different ways to demonstrate all the features of this integration.</p>
</div>
<div class="paragraph">
<p>Our application has one endpoint called <code>/order</code>, responsible for receiving requests to place orders
in our system. When we call this endpoint, we also call some other EJB services, like</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AccountService</code> to send a notification that an order has been placed</p>
</li>
<li>
<p><code>OrderService</code> to effectively place the order</p>
</li>
<li>
<p><code>InventoryService</code> to change our inventory</p>
</li>
<li>
<p><code>InventoryNotificationService</code>, to notify other backend systems.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As we are only interested in the tracing parts, we&#8217;ll not implement the business code itself, only the
scaffolding.</p>
</div>
<div class="paragraph">
<p>Our demo project is heavily based on the
<a href="https://github.com/opentracing-contrib/java-ejb/tree/release-0.0.2/opentracing-ejb-example"><code>opentracing-ejb-example</code></a>
from the repository <a href="https://github.com/opentracing-contrib/java-ejb"><code>opentracing-contrib/java-ejb</code></a>.
We have also prepared <a href="/data/blog/2017/2017-07-28-demo-example-complete.tar.gz">an archive</a> with the
final outcome of this demo, which you can use as reference.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_seed_project">The seed project</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To generate the seed project, open the <a href="http://wildfly-swarm.io/generator/">Wildfly Swarm generator</a>
and create a project with the "Group ID" <code>io.opentracing.contrib.ejb</code> and "Artifact ID"
<code>demo-example</code>. Add the dependencies <code>EJB</code>, <code>CDI</code>, <code>JAX-RS</code>, <code>OpenTracing</code>, and <code>Jaeger</code>.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Make sure to select all listed dependencies and confirm that they are shown in the "Selected dependencies"
section, otherwise, you might not have all the required fractions for this demo.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click on <code>Generate Project</code> and you&#8217;ll get a ZIP file with the seed project. Uncompress it and add the following
dependency to the <code>pom.xml</code>, within the <code>dependencies</code> node and after the <code>WildFly Swarm Fractions</code> dependencies:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-xml" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.opentracing.contrib&lt;/groupId&gt;
      &lt;artifactId&gt;opentracing-ejb&lt;/artifactId&gt;
      &lt;version&gt;0.0.2&lt;/version&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It&#8217;s now a good time to perform a sanity build, to make sure everything is in place. The first build might take a few minutes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ mvn wildfly-swarm:run
...
...
2017-07-26 12:02:19,154 INFO  [org.wildfly.swarm] (main) WFSWARM99999: WildFly Swarm is Ready</code></pre>
</div>
</div>
<div class="paragraph">
<p>If it looks good, stop the server with <code>Ctrl+C</code> and let&#8217;s start coding our application!</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_application">The application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s start by defining a JAX-RS endpoint that also acts as a stateless EJB. This is a common trick
to get JAX-RS endpoints to be managed as EJBs, so that they can be invoked via JMX or get
monitoring features. Or, in our case, to get traced via EJB interceptors.</p>
</div>
<div class="paragraph">
<p>This endpoint is where we get our HTTP requests from and where our transaction starts, from
the tracing perspective. Once we receive an HTTP request, we call the
<code>AccountService#sendNotification</code> method and then the <code>OrderService#processOrderPlacement</code>.</p>
</div>
<div class="paragraph">
<p>Note that we annotate the class with <code>@Interceptors(OpenTracingInterceptor.class)</code>, which means
that all methods on this class are to be traced.</p>
</div>
<div class="paragraph">
<p><code>src/main/java/io/opentracing/contrib/ejb/demoexample/Endpoint.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package io.opentracing.contrib.ejb.demoexample;

import io.opentracing.contrib.ejb.OpenTracingInterceptor;

import javax.ejb.Stateless;
import javax.inject.Inject;
import javax.interceptor.Interceptors;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import java.util.logging.Logger;

/**
 * This is a regular JAX-RS endpoint with EJB capabilities. We use the EJB capability to specify an interceptor,
 * so that every method on this class is wrapped on its own span. If the OpenTracing JAX-RS integration is being used,
 * it would be a good idea to not have the interceptor at this level, to avoid having too much "noise".
 *
 * @author Juraci Paixão Kröhling
 */
@Path("/order")
@Stateless
@Interceptors(OpenTracingInterceptor.class)
public class Endpoint {
    private static final Logger log = Logger.getLogger(Endpoint.class.getName());

    @Inject
    AccountService accountService;

    @Inject
    OrderService orderService;

    @POST
    @Path("/")
    public String placeOrder() {
        log.info("Request received to place an order");
        accountService.sendNotification();
        orderService.processOrderPlacement();
        return "Order placed";
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our <code>AccountService</code> is a simple stateless EJB, responsible for sending a notification about the new order
to the owner of the account. Here, we could call another service, or send an email, SMS or any other form
of message.</p>
</div>
<div class="paragraph">
<p>As this is a regular EJB, we are able to automatically join the span context from the JAX-RS endpoint, making
this call a child span of the main transaction. This is all transparent to you as developer.</p>
</div>
<div class="paragraph">
<p>Note again that we annotate the bean with <code>@Interceptors(OpenTracingInterceptor.class)</code>. As our interceptor
is just like any other EJB interceptor, you could use a <code>ejb-jar.xml</code> to automatically use this inteceptor on
all available beans. Whether or not to trace all beans is a per-deployment decision, so, no <code>ejb-jar.xml</code> is
provided by the integration.</p>
</div>
<div class="paragraph">
<p><code>src/main/java/io/opentracing/contrib/ejb/demoexample/AccountService.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package io.opentracing.contrib.ejb.demoexample;

import io.opentracing.contrib.ejb.OpenTracingInterceptor;

import javax.ejb.Stateless;
import javax.interceptor.Interceptors;
import java.util.logging.Logger;

/**
 * This is a simple synchronous EJB, without any knowledge about span context or other OpenTracing semantics. All it
 * does is specify an interceptor and it's shown as the child of a parent span.
 *
 * @author Juraci Paixão Kröhling
 */
@Stateless
@Interceptors(OpenTracingInterceptor.class)
public class AccountService {
    private static final Logger log = Logger.getLogger(AccountService.class.getName());

    public void sendNotification() {
        log.info("Notifying the account owner about a new order");
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our <code>OrderService</code> is responsible for actually placing the order: it&#8217;s where the business knowledge
resides. We&#8217;ll later look into details at the <code>InventoryService</code>, but for now, we need to know that
this service requires a <code>SpanContext</code> to be explicitly passed. We can get this context from the <code>EJBContext</code>,
stored under a context data entry that can be retrieved with the constant
<code>io.opentracing.contrib.ejb.OpenTracingInterceptor.SPAN_CONTEXT</code>.</p>
</div>
<div class="paragraph">
<p><code>src/main/java/io/opentracing/contrib/ejb/demoexample/OrderService.java</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package io.opentracing.contrib.ejb.demoexample;

import io.opentracing.SpanContext;
import io.opentracing.contrib.ejb.OpenTracingInterceptor;

import javax.annotation.Resource;
import javax.ejb.EJBContext;
import javax.ejb.Stateless;
import javax.inject.Inject;
import javax.interceptor.Interceptors;
import java.util.logging.Logger;

import static io.opentracing.contrib.ejb.OpenTracingInterceptor.SPAN_CONTEXT;

/**
 * This is a regular synchronous stateless EJB. It demonstrates how to get the span context for the span it's wrapped
 * on. This can be used to pass down the call chain, create child spans or add baggage items.
 *
 * @author Juraci Paixão Kröhling
 */
@Stateless
@Interceptors(OpenTracingInterceptor.class)
public class OrderService {
    private static final Logger log = Logger.getLogger(OrderService.class.getName());

    @Resource
    EJBContext ctx;

    @Inject
    InventoryService inventoryService;

    public void processOrderPlacement() {
        log.info("Placing order");
        Object ctxParentSpan = ctx.getContextData().get(SPAN_CONTEXT);
        if (ctxParentSpan instanceof SpanContext) {
            inventoryService.changeInventory((SpanContext) ctxParentSpan);
            return;
        }

        inventoryService.changeInventory(null);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Our <code>InventoryService</code> is responsible for interfacing with backend systems dealing with inventory control.
We don&#8217;t want to block the parent transaction while interacting with those systems, so, we make this an
asynchronous EJB. When dealing with asynchronous objects, it&#8217;s a good idea to be explicit about the span
context, as there are potential concurrency issues when sharing a context between a synchronous and an
asynchronous bean.</p>
</div>
<div class="paragraph">
<p>The OpenTracing EJB integration is able to intercept the method call and detect if there is a span context
among the parameters, which is the case of the <code>changeInventory(SpanContext)</code> method. In this situation,
the following happens behind the scenes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The caller makes a method call, passing the <code>SpanContext</code></p>
</li>
<li>
<p>The interceptor is activated, creating a new child span using the <code>SpanContext</code> as the parent</p>
</li>
<li>
<p>The interceptor replaces the original <code>SpanContext</code> with this new child span on the method call</p>
</li>
<li>
<p>The intercepted method is finally invoked, wrapped by the new child span.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that the <code>SpanContext</code> passed by the <code>OrderService</code> is not the same as the one received by <code>InventoryService</code>.
While this might cause some confusion, we believe this is the right semantic for this use case, as it allows
for a complete tracing picture, without any explicit tracing code, apart from passing the context around.</p>
</div>
<div class="paragraph">
<p><code>src/main/java/io/opentracing/contrib/ejb/demoexample/InventoryService.java</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package io.opentracing.contrib.ejb.demoexample;

import io.opentracing.SpanContext;
import io.opentracing.contrib.ejb.OpenTracingInterceptor;

import javax.ejb.Asynchronous;
import javax.ejb.Stateless;
import javax.inject.Inject;
import javax.interceptor.Interceptors;
import java.util.logging.Logger;

/**
 * This is an asynchronous stateless EJB with spans created automatically by the interceptor. Note that the span context
 * that this method sees is &lt;b&gt;not&lt;/b&gt; the same as the span context sent by the caller: the interceptor wraps this
 * method call on its own span, and replaces the span context by the context of this new span. This is done so that this
 * span context can be passed along to the next service "as is".
 *
 * @author Juraci Paixão Kröhling
 */
@Asynchronous
@Stateless
@Interceptors({OpenTracingInterceptor.class})
public class InventoryService {
    private static final Logger log = Logger.getLogger(InventoryService.class.getName());

    @Inject
    InventoryNotificationService inventoryNotificationService;

    public void changeInventory(SpanContext context) {
        log.info("Changing the inventory");
        inventoryNotificationService.sendNotification(context);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally, our last service, <code>InventoryNotificationService</code>: in this case, we notify another set of backend systems
that a new order has been placed. Again, this is an asynchronous EJB and works like the one above, but additionally,
we wanted to manually create a "business span", called <code>sendNotification</code>. This method could send several notifications,
wrapping each one into a span of its own. As we manually started it, we manually finish it as well.</p>
</div>
<div class="paragraph">
<p><code>src/main/java/io/opentracing/contrib/ejb/demoexample/InventoryNotificationService.java</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">package io.opentracing.contrib.ejb.demoexample;

import io.opentracing.Span;
import io.opentracing.SpanContext;
import io.opentracing.util.GlobalTracer;

import javax.ejb.Asynchronous;
import javax.ejb.Stateless;
import java.util.logging.Logger;

/**
 * This is the final call in the chain. This is an asynchronous stateless EJB, which obtains the span context
 * via a method parameter. This bean is not intercepted in any way by us, so, the span context received is exactly
 * the same as what was sent by the caller.
 *
 * @author Juraci Paixão Kröhling
 */
@Stateless
@Asynchronous
public class InventoryNotificationService {
    private static final Logger log = Logger.getLogger(InventoryNotificationService.class.getName());

    public void sendNotification(SpanContext context) {
        Span span = GlobalTracer.get().buildSpan("sendNotification").asChildOf(context).startManual();
        log.info("Sending an inventory change notification");
        span.finish();
    }

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, let&#8217;s do a final sanity check and see if everything is in the right place:
<code>mvn wildfly-swarm:run</code> . As before, the final message should be <code>WildFly Swarm is Ready</code>. Hit <code>Ctrl+C</code> and let&#8217;s
setup our tracing backend.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_tracing_backend">The tracing backend</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Instrumenting our code is one part of the story. The other part is to plug in an actual OpenTracing implementation that
is capable of capturing the spans and submitting them to a backend service. For our demo, we&#8217;ll use Jaeger. If you don&#8217;t
have a Jaeger server running yet, one can be started via Docker as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run \
    --rm \
    -p5775:5775/udp \
    -p6831:6831/udp \
    -p6832:6832/udp \
    -p5778:5778 \
    -p16686:16686 \
    -p14268:14268 \
    --name jaeger \
    jaegertracing/all-in-one:latest</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_tying_everything_together">Tying everything together</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Now that we have our code ready and a tracing backend, let&#8217;s start Wildfly Swarm passing a service name, which is the only
property required by the Jaeger client. By default, Jaeger&#8217;s Java tracer will attempt to send traces via UDP to a
Jaeger Agent located on the local machine. If you are using a different architecture, refer to the
<a href="https://github.com/uber/jaeger-client-java/tree/master/jaeger-core">Jaeger&#8217;s documentation</a>
on how to use environment variables to configure the client, or refer to the
<a href="https://github.com/wildfly-swarm/wildfly-swarm-examples/tree/master/jaeger/jaeger-servlet">Jaeger&#8217;s fraction for Wildfly Swarm</a>.</p>
</div>
<div class="paragraph">
<p>For our demo, we&#8217;ll use a property that is recognized by the Jaeger&#8217;s Wildfly Swarm Fraction. The other two properties are telling
Jaeger that every request should be sampled.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">mvn wildfly-swarm:run -Dswarm.jaeger.service-name=order-processing -Dswarm.jaeger.sampler-type=const -Dswarm.jaeger.sampler-parameter=1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Watch the logs for an entry containing <code>com.uber.jaeger.Configuration</code>: if everything is correctly set, it should show the
complete configuration of the Jaeger client, like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>2017-07-26 12:03:09,139 INFO  [com.uber.jaeger.Configuration] (ServerService Thread Pool -- 6) Initialized tracer=Tracer(version=Java-0.20.0, serviceName=order-processing, reporter=RemoteReporter(queueProcessor=RemoteReporter.QueueProcessor(open=true), sender=UdpSender(udpTransport=ThriftUdpTransport(socket=java.net.DatagramSocket@7270de22, receiveBuf=null, receiveOffSet=-1, receiveLength=0)), maxQueueSize=100, closeEnqueueTimeout=1000), sampler=ConstSampler(decision=true, tags={sampler.type=const, sampler.param=true}), ipv4=-1062731153, tags={hostname=carambola, jaeger.version=Java-0.20.0, ip=192.168.2.111}, zipkinSharedRpcSpan=false)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the message <code>WildFly Swarm is Ready</code> is seen, we can start making requests to our endpoint:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">$ curl -X POST localhost:8080/order
Order placed</code></pre>
</div>
</div>
<div class="paragraph">
<p>And this can be seen on the server&#8217;s log:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code>2017-07-26 12:03:19,302 INFO  [io.opentracing.contrib.ejb.demoexample.Endpoint] (default task-2) Request received to place an order
2017-07-26 12:03:19,304 INFO  [io.opentracing.contrib.ejb.demoexample.AccountService] (default task-2) Notifying the account owner about a new order
2017-07-26 12:03:19,307 INFO  [io.opentracing.contrib.ejb.demoexample.OrderService] (default task-2) Placing order
2017-07-26 12:03:19,314 INFO  [io.opentracing.contrib.ejb.demoexample.InventoryService] (EJB default - 1) Changing the inventory
2017-07-26 12:03:19,322 INFO  [io.opentracing.contrib.ejb.demoexample.InventoryNotificationService] (EJB default - 2) Sending an inventory change notification</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, the complete trace with its 6 spans can be seen on Jaeger&#8217;s UI, located at <a href="http://localhost:16686/search" class="bare">http://localhost:16686/search</a> , if you are using
the Docker command we listed before.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>EJBs are a very important part of Java EE and we expect the OpenTracing EJB framework integration to complement the other Java EE related
integrations, like the Servlet and JAX-RS. In this blog post, we&#8217;ve shown how tracing EJBs can be accomplished by transparently tracing
synchronous stateless EJBs, intercepting span contexts in asynchronous EJBs and by exposing the span context via EJB contexts, as well
as manually starting spans to include specific business logic into the trace.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links">Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OpenTracing: <a href="http://opentracing.io" class="bare">http://opentracing.io</a></p>
</li>
<li>
<p>OpenTracing EJB3 instrumentation (with example): <a href="https://github.com/opentracing-contrib/java-ejb" class="bare">https://github.com/opentracing-contrib/java-ejb</a></p>
</li>
<li>
<p>Jaeger: <a href="https://github.com/uber/jaeger" class="bare">https://github.com/uber/jaeger</a></p>
</li>
<li>
<p><a href="/data/blog/2017/2017-07-28-demo-example-complete.tar.gz">ZIP file</a> with the code from this blog post</p>
</li>
</ul>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2017/07/grafana-new-query-interface.html"><h1>Grafana: new query interface</h1></a>
            <p>24 July 2017, by Joel Takvorian</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>There have been improvements lately in the Hawkular Grafana datasource that are worth mentioning.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The way to query metrics by tags has changed since plugin <a href="https://github.com/hawkular/hawkular-grafana-datasource/releases/tag/v1.0.8">v1.0.8</a>.
It now takes advantage of the Hawkular Metrics' tags query language,
that was introduced server-side in <a href="http://www.hawkular.org/blog/2017/02/08/hawkular-metrics-0.24.0.Final-released.html">Metrics 0.24.0</a>
and enhanced in <a href="http://www.hawkular.org/blog/2017/03/07/hawkular-metrics-0.25.0.Final-released.html">0.25.0</a>.
To sum it up, Metrics integrates a parser that allows queries such as:
<code>tag1 = 'awesome!' AND tag2 NOT IN ['foo', 'bar']</code>.</p>
</li>
<li>
<p>The datasource in now able to fetch bucketized metrics stats, instead of raw metrics.
It consists in aggregating datapoints in slices of time (buckets) and providing, for each slice, some statistics like <em>min</em>, <em>max</em>, <em>average</em> and more.
The exact content of a bucket is described in <a href="http://www.hawkular.org/docs/rest/rest-metrics.html#NumericBucketPoint">Metrics REST API</a>.
Hawkular has always been able to provide metric stats server-side,
but being able to use them in the Grafana plugin is new, introduced in <a href="https://github.com/hawkular/hawkular-grafana-datasource/releases/tag/v1.0.9">v1.0.9</a>.</p>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-empty-query.png" alt="New query interface">
</div>
</div>
<div class="paragraph text-center">
<p><em>The new query interface</em></p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_tags_query_language">Tags query language</h3>
<div class="paragraph">
<p>The first change is that you don&#8217;t have to choose between <em>query by tag</em> and <em>query by metric id</em> anymore, you can do both at the same time.
Querying by tag will refine the available list of metric names (much like a filter) and can result in multiple metrics from a single query.
By selecting a <em>metric name</em>, you restrict the query to only display that one.
This filtering is really nice when there&#8217;s tons of metrics available, like in the case of
hundreds of OpenShift pods being monitored with the same tenant.</p>
</div>
<div class="paragraph">
<p>The simple <em>key/value</em> pairs interface is now replaced with a more elaborated query builder, following the pattern:
<em>'tag-key'</em> <em>'operator'</em> <em>'tag-value(s)'</em> [<em>'AND/OR'</em> etc.]</p>
</div>
<div class="paragraph">
<p>The following images show a walk-through:</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-tag_key.png" alt="Selecting tag key">
</div>
</div>
<div class="paragraph text-center">
<p><em>Selecting the tag key</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-tag_operator.png" alt="Selecting tag operator">
</div>
</div>
<div class="paragraph text-center">
<p><em>Selecting the tag operator</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-tag_value.png" alt="Selecting tag value">
</div>
</div>
<div class="paragraph text-center">
<p><em>Selecting the tag value</em></p>
</div>
<div class="paragraph">
<p>The text fields include dynamic suggestions, you can use Grafana template variables within tag values, or enter free text.
Once you&#8217;ve set up a tag query expression, the relevant metrics immediately show up on the chart and the list of available metrics in the dropdown list in updated.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-tag-filtering.png" alt="Filtered metrics">
</div>
</div>
<div class="paragraph text-center">
<p><em>Filtered metrics</em></p>
</div>
<div class="paragraph">
<p>This query builder lets you build almost any tag query that the Hawkular server understands.
There are however some corner cases. For now this builder doesn&#8217;t allow you to prioritize expressions with parentheses.
For instance, you cannot build <code>c1 = 'foo' OR (b1 != 'B' AND a1 = 'abcd')</code>.
As a workaround you can turn off the query builder and directly type in your query expression.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-editor-mode.png" alt="Toggle editor mode">
</div>
</div>
<div class="paragraph text-center">
<p><em>Toggle editor mode</em></p>
</div>
<div class="paragraph">
<p>It will be sent as is to the Hawkular Metrics server.
This will also be useful to fill the gap if the language evolves server-side and this plugin isn&#8217;t updated immediately.</p>
</div>
</div>
<div class="sect2">
<h3 id="_stats_query">Stats query</h3>
<div class="paragraph">
<p>The other important feature is the ability to run <a href="http://www.hawkular.org/hawkular-metrics/docs/user-guide/#_downsampling">stats</a> queries against Hawkular Metrics, instead of <a href="http://www.hawkular.org/hawkular-metrics/docs/user-guide/#_raw_data">raw</a> queries.
There are several reasons to do this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>it reduces the network load, and client-side processing load, especially when raw data would contain tons of datapoints</p>
</li>
<li>
<p>it enables some aggregation methods</p>
</li>
<li>
<p>it also allows higher-level analysis with stats such as percentiles</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To enable it, just clear the <em>raw</em> checkbox.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-stats-mode.png" alt="Toggle stats mode">
</div>
</div>
<div class="paragraph text-center">
<p><em>Toggle stats mode</em></p>
</div>
<div class="paragraph">
<p>When you clear the <em>raw</em> checkbox, you can configure <em>Multiple series aggregation</em> to <em>None</em>, <em>Sum</em> or <em>Average</em>
and can configure <em>Stat type</em> as <em>avg</em>, <em>min</em>, <em>max</em>, <em>median</em>, <em>sum</em> and different percentiles.
You can display several different <em>Stat types</em> within the same query.</p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-stats-none.png" alt="Stats without aggregation">
</div>
</div>
<div class="paragraph text-center">
<p><em>Stats without aggregation: each two metrics show avg, min and max</em></p>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="/img/blog/2017/2017-07-20-grafana-stats-avg.png" alt="Stats avg">
</div>
</div>
<div class="paragraph text-center">
<p><em>Same query with series aggregation: the two metrics are averaged into one, which shows avg, min and max</em></p>
</div>
<div class="paragraph">
<p>If the query returns multiple series, use <em>Multiple series aggregation</em> to define if and how to aggregate them.
<em>None</em> will show them individually on the chart. But consider for instance the case of an OpenShift pod with many replicas, and you&#8217;re tracking their memory usage.
It may be more relevant here to aggregate all of them, both <em>sum</em> and <em>average</em> are meaningful here.</p>
</div>
<div class="paragraph">
<p>The <em>Stat type</em> option refers to an aggregation at a different level: not between multiple metrics, but within a single metric,
all raw datapoints are aggregated within time buckets.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>These two improvements aim a common goal, that is facilitating querying over large amounts of data. This is becoming crucial especially
in the context of microservices and applications running on container platforms, as the number of metrics explodes.
Proper metrics tagging is the corner stone to make sense of this data.</p>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2017/07/jaeger-with-security-proxy.html"><h1>Protecting Jaeger UI with a sidecar security proxy</h1></a>
            <p>18 July 2017, by Juraci Paixão Kröhling</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In a production deployment of Jaeger, it may be advantageous to restrict access to Jaeger&#8217;s Query
service, which includes the UI. For instance, you might have internal security requirements to allow
only certain groups to access trace data, or you might have deployed Jaeger into a public cloud.
In a true microservices way, one possible approach is to add a sidecar to the Jaeger Query service,
acting as a security proxy. Incoming requests hit our sidecar instead of reaching Jaeger&#8217;s Query service
directly and the sidecar would be responsible for enforcing the authentication and authorization constraints.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-07-18-teaser.png" alt="Jaeger login screen">
</div>
</div>
<div class="paragraph">
<p>Incoming HTTP requests arrive at the route ①, which uses the internal service ② to resolve and communicate
with the security proxy ③. Once the request is validated and all security constraints are satisfied, the
request reaches Jaeger ④.</p>
</div>
<div class="paragraph">
<p>For demonstration purposes we&#8217;ll make use of <a href="http://keycloak.org">Keycloak</a> as our security solution, but
the idea can be adapted to work with any security proxy. This demo should also work without changes with
<a href="https://access.redhat.com/products/red-hat-single-sign-on">Red Hat SSO</a>. For this exercise, we&#8217;ll need:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A Keycloak (or Red Hat SSO) server instance running. We&#8217;ll call its location <code>${REDHAT_SSO_URL}</code></p>
</li>
<li>
<p>An OpenShift cluster, where we&#8217;ll run Jaeger backend components. It might be as easy as <code>oc cluster up</code></p>
</li>
<li>
<p>A local clone of the <a href="https://github.com/jaegertracing/jaeger-openshift/blob/master/production/jaeger-production-template.yml">Jaeger OpenShift Production template</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that we are not trying to secure the communication between the components, like from the Agent to the Collector.
For this scenario, there are other techniques that can be used, such as mutual authentication via certificates, employing
<a href="https://istio.io/">istio</a> or other similar tools.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_preparing_keycloak">Preparing Keycloak</h3>
<div class="paragraph">
<p>For this demo, we&#8217;ll run Keycloak via Docker directly on the host machine. This is to stress that Keycloak
does <strong>not</strong> need to be running on the same OpenShift cluster as our Jaeger backend.</p>
</div>
<div class="paragraph">
<p>The following command should start an appropriate Keycloak server locally. If you already have your
own Keycloak or Red Hat SSO server, skip this step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">docker run --rm --name keycloak-server -e KEYCLOAK_USER=admin -e KEYCLOAK_PASSWORD=password -p 8080:8080 jboss/keycloak</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the Keycloak server is up and running, let&#8217;s create a realm for Jaeger:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Login into Keycloak (<a href="http://&lt;YOUR_IP&gt;:8080/auth/admin/master/console" class="bare">http://&lt;YOUR_IP&gt;:8080/auth/admin/master/console</a>) with <code>admin</code> as username and <code>password</code> as password</p>
</li>
<li>
<p>In the top left corner, mouse over the <code>Select realm</code> box and click <code>Add realm</code>. Name it <code>jaeger</code> and click <code>Create</code></p>
</li>
<li>
<p>On <code>Clients</code>, click <code>Create</code> and set <code>proxy-jaeger</code> as the name and save it</p>
</li>
<li>
<p>Set the <code>Access Type</code> to <code>confidential</code> and <code>*</code> as <code>Valid Redirect URIs</code> and save it. You might want to fine tune this in a
production environment, otherwise you might be open to an attack known as
<a href="https://www.owasp.org/index.php/Unvalidated_Redirects_and_Forwards_Cheat_Sheet">"Unvalidated Redirects and Forwards"</a>.</p>
</li>
<li>
<p>Open the <code>Installation</code> tab and select <code>Keycloak OIDC JSON</code> and copy the JSON that is shown. It should look like this,
but the <code>auth-server-url</code> and <code>secret</code> will have different values.</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-json" data-lang="json">{
  "realm": "jaeger",
  "auth-server-url": "http://192.168.2.111:8080/auth",
  "ssl-required": "external",
  "resource": "proxy-jaeger",
  "credentials": {
    "secret": "7f201319-1dfd-43cc-9838-057dac439046"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>And finally, let&#8217;s create a role and a user, so that we can log into Jaeger&#8217;s Query service:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Under the <code>Configure</code> left-side menu, open the <code>Roles</code> page and click <code>Add role</code></p>
</li>
<li>
<p>As role name, set <code>user</code> and click <code>Save</code></p>
</li>
<li>
<p>Under the <code>Manage</code> left-side menu, open the <code>Users</code> page and click <code>Add user</code></p>
</li>
<li>
<p>Fill out the form as you wish and set <code>Email verified</code> to <code>ON</code> and click on <code>Save</code></p>
</li>
<li>
<p>Open the <code>Credentials</code> tab for this user and set a password (temporary or not).</p>
</li>
<li>
<p>Open the <code>Role mappings</code> tab for this user, select the role <code>user</code> from the <code>Available Roles</code> list and click <code>Add selected</code></p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_preparing_openshift">Preparing OpenShift</h3>
<div class="paragraph">
<p>For this demo, we assume you have an OpenShift cluster running already. If you don&#8217;t, then you might want to check out tools
like <a href="https://github.com/minishift/minishift"><code>minishift</code></a>. If you are running a recent version of Fedora, CentOS or
Red Hat Enterprise Linux you might want to install the package <code>origin-clients</code> and run <code>oc cluster up --version=latest</code>.
This should get you a basic OpenShift cluster running locally.</p>
</div>
<div class="paragraph">
<p>To make it easier for our demonstration, we&#8217;ll add <code>cluster-admin</code> rights to our <code>developer</code> user and we&#8217;ll create
the Jaeger namespace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">oc login -u system:admin
oc new-project jaeger
oc adm policy add-cluster-role-to-user cluster-admin developer -n jaeger
oc login -u developer</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_preparing_the_jaeger_openshift_template">Preparing the Jaeger OpenShift template</h3>
<div class="paragraph">
<p>We&#8217;ll use the <a href="https://github.com/jaegertracing/jaeger-openshift/blob/master/production/jaeger-production-template.yml">Jaeger OpenShift Production template</a>
as the starting point: either clone the entire repository, or just get a local version of the template.</p>
</div>
<div class="paragraph">
<p>The first step is to add the sidecar container to the <code>query-deployment</code> object. Under the <code>containers</code> list, after we
specify the <code>jaeger-query</code>, let&#8217;s add the sidecar:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">        - image: jboss/keycloak-proxy
          name: ${JAEGER_SERVICE_NAME}-query-security-proxy
          volumeMounts:
          - mountPath: /opt/jboss/conf
            name: security-proxy-configuration-volume
          ports:
          - containerPort: 8080
            protocol: TCP
          readinessProbe:
            httpGet:
              path: "/"
              port: 8080</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that container specifies a <code>volumeMount</code> named <code>security-proxy-configuration-volume</code>: we&#8217;ll use it to store the
proxy&#8217;s configuration file. You should add the volume under the <code>spec/template/spec</code> node for <code>query-deployment</code>, sibling to
the <code>dnsPolicy</code> property (it&#8217;s probably right under the previous code snippet):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">        volumes:
          - configMap:
              name: ${JAEGER_SERVICE_NAME}-configuration
              items:
                - key: proxy
                  path: proxy.json
            name: security-proxy-configuration-volume</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, we need to specify the <code>ConfigMap</code>, with the proxy&#8217;s configuration entry. To do that, we add a new top-level item to
the template. As a suggestion, we recommend keeping it close to where it&#8217;s consumed. For instance, right before the <code>query-deployment</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">- apiVersion: v1
  kind: ConfigMap
  metadata:
    name: ${JAEGER_SERVICE_NAME}-configuration
    labels:
      app: jaeger
      jaeger-infra: security-proxy-configuration
  data:
    proxy: |
      {
          "target-url": "http://localhost:16686",
          "bind-address": "0.0.0.0",
          "http-port": "8080",
          "applications": [
              {
                  "base-path": "/",
                  "adapter-config": {
                    "realm": "jaeger",
                    "auth-server-url": "${REDHAT_SSO_URL}",
                    "ssl-required": "external",
                    "resource": "proxy-jaeger",
                    "credentials": {
                      "secret": "THE-SECRET-FROM-INSTALLATION-FILE"
                    }
                  }
            ,
            "constraints": [
                      {
                          "pattern": "/*",
                          "roles-allowed": [
                              "user"
                          ]
                      }
                  ]
              }
          ]
      }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that we are only allowing users with the role <code>user</code> to log into our Jaeger UI. In a real world scenario, you might
want to adjust this to fit your setup. For instance, your user data might come from LDAP, and you only want to allow users
from specific LDAP groups to access the Jaeger UI.</p>
</div>
<div class="paragraph">
<p>The <code>secret</code> within the <code>credentials</code> should match the secret we got from Keycloak at the beginning of this exercise. Our
most curious readers will note that we mentioned the template parameter <code>REDHAT_SSO_URL</code> under the property <code>auth-server-url</code>.
Either change that to your Keycloak server, or let&#8217;s specify a template parameter, allowing us to set this at deployment time.
Under the <code>parameters</code> section of the template, add the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">- description: The URL to the Red Hat SSO / Keycloak server
  displayName: Red Hat SSO URL
  name: REDHAT_SSO_URL
  required: true
  value: http://THE-URL-FROM-THE-INSTALLATION-FILE:8080/auth</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This value should be a location that is reacheable by both your browser and by the sidecar, like your host&#8217;s LAN IP (192.x, 10.x).
Localhost/127.x is not going to work.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As a final step, we need to change the service to direct requests to the port <code>8080</code> (proxy) instead of <code>16686</code>. This is done
by changing the property <code>targetPort</code> on the service named <code>query-service</code>, setting it to <code>8080</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-yml" data-lang="yml">- apiVersion: v1
  kind: Service
  metadata:
    name: ${JAEGER_SERVICE_NAME}-query
    labels:
      app: jaeger
      jaeger-infra: query-service
  spec:
    ports:
    - name: jaeger-query
      port: 80
      protocol: TCP
      targetPort: 8080
    selector:
      jaeger-infra: query-pod
    type: LoadBalancer</code></pre>
</div>
</div>
<div class="paragraph">
<p>As a reference, here&#8217;s the <a href="https://github.com/jaegertracing/jaeger-openshift/blob/KeycloakSecuringUI/production/jaeger-production-template.yml">complete template file</a>
that can be used for this blog post.</p>
</div>
</div>
<div class="sect2">
<h3 id="_deploying">Deploying</h3>
<div class="paragraph">
<p>Now that we have everything ready, let&#8217;s deploy Jaeger into our OpenShift cluster. Run the following command from the same
directory you stored the <code>YAML</code> file from the previous steps, referenced here by the name <code>jaeger-production-template.yml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-bash" data-lang="bash">oc process -f jaeger-production-template.yml | oc create -n jaeger -f -</code></pre>
</div>
</div>
<div class="paragraph">
<p>During the first couple of minutes, it&#8217;s OK if the pods <code>jaeger-query</code> and <code>jaeger-collector</code> fail, as Cassandra will still
be booting. Eventually, the service should be up and running, as shown in the following image.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/2017-07-18-pod.png" alt="Pod with sidecar on OpenShift">
</div>
</div>
<div class="paragraph">
<p>Once it is ready to serve requests, click on URL for the route (<a href="https://jaeger-query-jaeger.127.0.0.1.nip.io" class="bare">https://jaeger-query-jaeger.127.0.0.1.nip.io</a>). You should be
presented with a login screen, served by the Keycloak server. Login with the credentials you set on the previous steps, and you
should reach the regular Jaeger UI.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion">Conclusion</h3>
<div class="paragraph">
<p>In this exercise, we&#8217;ve seen how to add a security proxy to our Jaeger Query pod as a sidecar. All incoming requests go through
this sidecar and all features available in Keycloak can be used transparently, such as 2-Factor authentication, service accounts,
single sign-on, brute force attack protection, LDAP support and much more.</p>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />
            <a href="blog/2017/07/opentracing-jaxrs.html"><h1>OpenTracing JAX-RS Instrumentation</h1></a>
            <p>10 July 2017, by Pavol Loffay</p>
            <p><div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In the previous <a href="http://www.hawkular.org/blog/2017/06/9/opentracing-spring-boot.html">demo</a>
we have demonstrated how to instrument a Spring Boot app
using <a href="http://opentracing.io">OpenTracing</a>, a vendor-neutral standard for distributed tracing.
In this article we are going to instrument a Java API for RESTful Web Services (JAX-RS), and show
you how to trace the business layer and add custom data to the trace.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_demo_application">Demo application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Creating a JAX-RS app from scratch can be a time consuming task, therefore in this case we are going to use
Wildfly Swarm&#8217;s <a href="http://wildfly-swarm.io/generator/">app generator</a>.
Select JAX-RS and CDI dependencies and hit generate button.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/wf-swarm-generator.png" alt="wf swarm generator">
</div>
<div class="title">Figure 1: Wildfly Swarm generator.</div>
</div>
<div class="paragraph">
<p>The generated application contains one REST endpoint which returns hello world string.
This endpoint is accessible on <code><a href="http://localhost:8080/hello" class="bare">http://localhost:8080/hello</a></code>.
In the next step we are going to add instrumentation and simple business logic.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instrumentation">Instrumentation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Adding OpenTracing instrumentation to JAX-RS is very simple, just include the following dependency in
the classpath and the tracing feature will be automatically registered.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dependency&gt;
    &lt;groupId&gt;io.opentracing.contrib&lt;/groupId&gt;
    &lt;artifactId&gt;opentracing-jaxrs2&lt;/artifactId&gt;
&lt;/dependency&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>OpenTracing is just an API, therefore it is required to register a specific tracer instance. In this demo
we are going to use <a href="https://github.com/uber/jaeger">Jaeger tracing system</a>. The tracer should be created
and initialized only once per process, hence <code>ServletContextListener</code> is the ideal place for this task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">@WebListener
public class TracingContextListener implements ServletContextListener {

  @Inject
  private io.opentracing.Tracer tracer;

  @Override
  public void contextInitialized(ServletContextEvent sce) {
    GlobalTracer.register(tracer);
  }

  @Override
  public void contextDestroyed(ServletContextEvent sce) {}

  @Produces
  @Singleton
  public static io.opentracing.Tracer jaegerTracer() {
    return new Configuration("wildfly-swarm", new Configuration.SamplerConfiguration(
        ProbabilisticSampler.TYPE, 1),
        new Configuration.ReporterConfiguration())
        .getTracer();
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tracer initialization code requires to specify app name, which is in this case <code>wildfly-swarm</code> and
sampler configuration.</p>
</div>
<div class="paragraph">
<p>Note that we are suing Java&#8217;s Context and Dependency Injection (CDI) to share a tracer instance in our app.
If we forget to register a specific tracer instance, then the tracing feature would use <code>NoopTracer</code>.
Now we can verify tracing by starting Jaeger server using the following command:
<code>docker run --rm -it --network=host jaegertracing/all-in-one</code> and accessing the endpoint at
<code><a href="http://localhost:8080/hello" class="bare">http://localhost:8080/hello</a></code>. Our trace with one span should be present in the UI at
<code><a href="http://localhost:16686" class="bare">http://localhost:16686</a></code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_instrumenting_business_logic">Instrumenting business logic</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JAX-RS instrumentation provides nice visibility into your app, however, it is often
necessary to add custom data to the trace to see what is happening in the service or database layer.</p>
</div>
<div class="paragraph">
<p>The following code snippet shows how the service layer can create and add data to the trace:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight"><code class="language-java" data-lang="java">public class BackendService {

  @Inject
  private io.opentracing.Tracer tracer;

  public String action() throws InterruptedException {
    int random = new Random().nextInt(200);

    try (ActiveSpan span = tracer.buildSpan("action").startActive()) {
      anotherAction();
      Thread.sleep(random);
    }

    return String.valueOf(random);
  }

  private void anotherAction() {
    tracer.activeSpan().setTag("anotherAction", "data");
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that it&#8217;s not necessary to manually pass a span instance around. The method <code>anotherAction</code> accesses
the current active span from the tracer.</p>
</div>
<div class="paragraph">
<p>With the additional instrumentation shown above, an invocation of the REST endpoint would result in
a trace consisting of two spans, one representing the inbound server request, and the other the business logic.
The span representing server processing is automatically considered as the parent for span created in business layer.
If we created span in <code>anotherAction</code> then its parent would be span created in <code>action</code> method.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/img/blog/2017/swarm-jaeger.png" alt="swarm jaeger">
</div>
<div class="title">Figure 1: Jaeger showing reported spans.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_video">Video</h2>
<div class="sectionbody">
<div class="videoblock">
<div class="content">
<iframe width="853" height="480" src="https://www.youtube.com/embed/gVwLenPH8SY?rel=0" frameborder="0" allowfullscreen></iframe>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_conclusion">Conclusion</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We have demonstrated that instrumenting a JAX-RS app is just a matter of adding a dependency
and registering a tracer instance. If we would like to use a different OpenTracing implementation,
Zipkin for instance, it would just require changing tracer producer code. No changes to the application or
business logic! In the next demo we will wire this app with Spring Boot created
in previous demo and deploy them on Kubernetes.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_links">Links</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>OpenTracing: <a href="http://opentracing.io" class="bare">http://opentracing.io</a></p>
</li>
<li>
<p>Github repository with demo: <a href="https://github.com/pavolloffay/opentracing-java-examples" class="bare">https://github.com/pavolloffay/opentracing-java-examples</a></p>
</li>
<li>
<p>OpenTracing JAX-RS instrumentation: <a href="https://github.com/opentracing-contrib/java-jaxrs" class="bare">https://github.com/opentracing-contrib/java-jaxrs</a></p>
</li>
<li>
<p>Jaeger: <a href="https://github.com/uber/jaeger" class="bare">https://github.com/uber/jaeger</a></p>
</li>
</ul>
</div>
</div>
</div></p>
            <br />
            <hr /><br />
            <br />



    <div class="large-4 columns blog-post-listings">
        <h2>Older posts:</h2>
        <ul>
          <li>26 June 2017 - <a href="blog/2017/06/26/opentracing-appmetrics.html">Using OpenTracing to collect Application Metrics in Kubernetes</a></li>
          <li>13 June 2017 - <a href="blog/2017/06/9/opentracing-spring-boot.html">OpenTracing Spring Boot Instrumentation</a></li>
          <li>06 June 2017 - <a href="blog/2017/06/06/hawkular-metrics-0.27.0.Final-released.html">Hawkular Metrics 0.27.0 - Release</a></li>
          <li>31 May 2017 - <a href="blog/2017/05/31/hawkular-grafana-ootb.html">Hawkular and Grafana Out of the Box</a></li>
          <li>25 May 2017 - <a href="blog/2017/05/25/jaeger-contributions.html">Kubernetes and OpenShift Templates for Jaeger</a></li>
          <li>03 May 2017 - <a href="blog/2017/05/03/hawkular-services-0.37-released.html">Hawkular Services 0.37.Final</a></li>
          <li>27 April 2017 - <a href="blog/2017/04/27/hawkular-alerting-tutorial-l6.html">Hawkular Alerting Tutorial: Lesson 06 - Events!</a></li>
          <li>19 April 2017 - <a href="blog/2017/04/19/hawkular-apm-jaeger.html">Hawkular APM: The Future</a></li>
          <li>07 April 2017 - <a href="blog/2017/04/07/cloudnativecon-summary.html">CloudNativeCon summary</a></li>
          <li>06 April 2017 - <a href="blog/2017/04/06/hawkular-alerting-elasticsearch.html">Alerts and Notifications for Elasticsearch using Hawkular Alerting</a></li>
          <li>05 April 2017 - <a href="blog/2017/04/05/deploy-hosa-easily.html">Deploying Hawkular OpenShift Agent Easily</a></li>
          <li>04 April 2017 - <a href="blog/2017/04/04/hawkular-metrics-0.26.0.Final-released.html">Hawkular Metrics 0.26.0 - Release</a></li>
          <li>25 March 2017 - <a href="blog/2017/03/25/collecting-application-metrics-openshift.html">Collecting Application Metrics Within OpenShift</a></li>
          <li>24 March 2017 - <a href="blog/2017/03/24/distributed-tracing-with-camel.html">Distributed Tracing with Apache Camel and OpenTracing</a></li>
          <li>24 March 2017 - <a href="blog/2017/03/24/hawkular-java-agent.html">Introducing Hawkular Java Agent</a></li>
          <li>22 March 2017 - <a href="blog/2017/03/22/apm-adjusting-sampling-rate.html">Adjusting sampling rates for Hawkular APM on OpenShift</a></li>
          <li>15 March 2017 - <a href="blog/2017/03/15/hawkular-opentracing-otsc.html">Distributed Tracing Workshop and OpenTracing Collaboration</a></li>
          <li>14 March 2017 - <a href="blog/2017/03/14/hawkular-alerting-tutorial.html">Hawkular Alerting: Tutorial Now Available!</a></li>
          <li>07 March 2017 - <a href="blog/2017/03/07/hawkular-metrics-0.25.0.Final-released.html">Hawkular Metrics 0.25.0 - Release</a></li>
          <li>22 February 2017 - <a href="blog/2017/02/22/pandas-and-hawkular-metrics.html">Processing Hawkular-Metrics data with Python Pandas</a></li>
          <li>15 February 2017 - <a href="blog/2017/02/15/hawkular-services-0.32-released.html">Hawkular Services 0.32.Final</a></li>
          <li>13 February 2017 - <a href="blog/2017/02/13/monitoring-canary-deployments.html">Monitoring Canary Releases with Hawkular APM</a></li>
          <li>08 February 2017 - <a href="blog/2017/02/08/hawkular-metrics-0.24.0.Final-released.html">Hawkular Metrics 0.24.0 - Release</a></li>
          <li>07 February 2017 - <a href="blog/2017/02/07/hawkular-metrics-roadmap.html">Hawkular Metrics - 2017 Roadmap</a></li>
          <li>04 February 2017 - <a href="blog/2017/02/04/hawkular-apm-service-deployments.html">Hawkular APM: Comparing performance of service versions</a></li>
          <li>03 February 2017 - <a href="blog/2017/02/03/grafana-events.html">Display custom events in Grafana</a></li>
          <li>31 January 2017 - <a href="blog/2017/01/31/hawkular-services-0.30-released.html">Hawkular Services 0.30.0.Final</a></li>
          <li>27 January 2017 - <a href="blog/2017/01/27/hosa-status.html">Getting the status of Hosa</a></li>
          <li>17 January 2017 - <a href="blog/2017/01/17/obst-hosa.html">Monitoring Microservices on OpenShift with HOSA</a></li>
          <li>16 January 2017 - <a href="blog/2017/01/16/hawkular-metrics-with-dropwizard.html">Reporting Dropwizard metrics to Hawkular</a></li>
          <li>13 January 2017 - <a href="blog/2017/01/13/events-aggregation-extension.html">Extending Complex Event Processing in Hawkular Alerting</a></li>
          <li>04 January 2017 - <a href="blog/2017/01/04/hawkular-metrics-0.23.0.Final-released.html">Hawkular Metrics 0.23.0 - Release</a></li>
          <li>22 December 2016 - <a href="blog/2016/12/22/hawkular-hawkinit-cli-tool.html">Hawkinit</a></li>
          <li>16 December 2016 - <a href="blog/2016/12/16/hawkular-apm-vertx-opentracing-openshift.html">Hawkular APM improvements for OpenShift</a></li>
          <li>06 December 2016 - <a href="blog/2016/12/06/hawkular-metrics-0.22.0.Final-released.html">Hawkular Metrics 0.22.0 - Release</a></li>
          <li>25 November 2016 - <a href="blog/2016/11/25/hawkular-apm-on-openshift.html">Using Hawkular APM on OpenShift</a></li>
          <li>16 November 2016 - <a href="blog/2016/11/16/hawkular-apm-opentracing-js.html">Hawkular APM OpenTracing JavaScript</a></li>
          <li>09 November 2016 - <a href="blog/2016/11/09/hawkular-services-0.20.0.Final.html">Hawkular Services 0.20.0.Final</a></li>
          <li>25 October 2016 - <a href="blog/2016/10/25/hawkular-metrics-0.21.0.Final-released.html">Hawkular Metrics 0.21.0 - Release</a></li>
          <li>24 October 2016 - <a href="blog/2016/10/24/hawkfx-alerts.html">Define Alert Triggers via HawkFX</a></li>
          <li>24 October 2016 - <a href="blog/2016/10/24/hawkular-metrics-openshift-and-grafana.html">Monitoring Microservices with OpenShift, Hawkular Metrics and Grafana</a></li>
          <li>17 October 2016 - <a href="blog/2016/10/17/hawkular-apm-opentracing-and-alerts.html">Hawkular APM supports OpenTracing and Alerts</a></li>
          <li>14 October 2016 - <a href="blog/2016/10/14/hawkular-apm-polyglot-zipkin.html">Hawkular APM Distributed Tracing of Polyglot Application using Zipkin Instrumentations</a></li>
          <li>06 October 2016 - <a href="blog/2016/10/06/hawkular-metrics-0.20.0.Final-released.html">Hawkular Metrics 0.20.0 - Release</a></li>
          <li>19 September 2016 - <a href="blog/2016/09/19/hawkular-apm-on-msa.html">Using Hawkular APM on Red Hat&apos;s Microservices Reference Architecture example</a></li>
          <li>14 September 2016 - <a href="blog/2016/09/14/consuming-hawkular-api-over-ssl.html">Consuming Hawkular API over SSL with self signed certificates</a></li>
          <li>05 September 2016 - <a href="blog/2016/09/05/hawkular-metrics-0.19.0.Final-released.html">Hawkular Metrics 0.19.0 - Release</a></li>
          <li>31 August 2016 - <a href="blog/2016/08/31/spark-metric-analysis.html">Metric Data Analysis using the Apache Spark</a></li>
          <li>11 August 2016 - <a href="blog/2016/08/11/vertx-agent-inventory-impl.html">Vert.x agent inventory implementation</a></li>
          <li>01 August 2016 - <a href="blog/2016/08/01/hawkular-metrics-0.18.0.Final-released.html">Hawkular Metrics 0.18.0 - Release</a></li>
          <li>19 July 2016 - <a href="blog/2016/07/19/android-client-progess.html">What is new in Android Client</a></li>
          <li>14 July 2016 - <a href="blog/2016/07/14/hawkular-apm-openshift.html">Monitoring Application Performance within Openshift</a></li>
          <li>14 July 2016 - <a href="blog/2016/07/14/hawkular-miq.html">Getting started with ManageIQ and Hawkular</a></li>
          <li>13 July 2016 - <a href="blog/2016/07/13/hawkfx.html">Introducing HawkFX</a></li>
          <li>12 July 2016 - <a href="blog/2016/07/12/hawkular-and-jmx-jolokia.html">Hawkular and JMX/Jolokia</a></li>
          <li>12 July 2016 - <a href="blog/2016/07/12/hawkular-and-prometheus.html">Hawkular and Prometheus</a></li>
          <li>06 July 2016 - <a href="blog/2016/07/06/hawkular-metrics-0.17.0.Final-released.html">Hawkular Metrics 0.17.0 - Release</a></li>
          <li>05 July 2016 - <a href="blog/2016/07/05/hawkular-services-0.0.5.Final.html">Hawkular Services 0.0.5.Final</a></li>
          <li>05 July 2016 - <a href="blog/2016/07/05/scaling-hawkular-alerting.html">Scaling stateful services: an example in Hawkular Alerting</a></li>
          <li>27 June 2016 - <a href="blog/2016/06/27/hawkular-apm-0.9-released.html">Hawkular APM 0.9.0.Final Released</a></li>
          <li>14 June 2016 - <a href="blog/2016/06/14/hawkular-services-0.0.2.Final.html">Hawkular Services 0.0.2.Final</a></li>
          <li>01 June 2016 - <a href="blog/2016/06/01/hawkular-btm-to-apm.html">Hawkular BTM component rename</a></li>
          <li>01 June 2016 - <a href="blog/2016/06/01/hawkular-metrics-0.16.0.Final-released.html">Hawkular Metrics 0.16.0 - Release</a></li>
          <li>26 May 2016 - <a href="blog/2016/05/26/hawkular-btm-booker-demo.html">Monitoring Microservices for Application Performance, Distributed Tracing and Business Transactions</a></li>
          <li>24 May 2016 - <a href="blog/2016/05/24/hawkular-btm-ticketmonster-demo.html">Obtaining business metrics without the need to instrument your application</a></li>
          <li>02 May 2016 - <a href="blog/2016/05/02/hawkular-metrics-0.15.0.Final-released.html">Hawkular Metrics 0.15.0 - Release</a></li>
          <li>28 April 2016 - <a href="blog/2016/04/28/new-packaging.html">New Hawkular packaging</a></li>
          <li>27 April 2016 - <a href="blog/2016/04/27/hawkular-inventory-0.15.0.Final-released.html">Hawkular Inventory 0.15.0.Final - Release</a></li>
          <li>22 April 2016 - <a href="blog/2016/04/22/collecting-metrics-from-prometheus-endpoints.html">Collecting Metrics from Prometheus Endpoints</a></li>
          <li>21 April 2016 - <a href="blog/2016/04/21/datamining-first-release.html">Hawkular Data Mining 0.1.0.Final Released</a></li>
          <li>19 April 2016 - <a href="blog/2016/04/19/jmxtrans-to-hawkular-metrics.html">Monitoring JVM applications with jmxtrans</a></li>
          <li>08 April 2016 - <a href="blog/2016/04/08/hawkular-manage-iq-sprint-demo.html">Hawkular in ManageIQ sprint demo(s)</a></li>
          <li>29 March 2016 - <a href="blog/2016/03/29/hawkular-metrics-0.14.0.Final-released.html">Hawkular Metrics 0.14.0 - Release</a></li>
          <li>21 March 2016 - <a href="blog/2016/03/20/qr-android.html">QR Code support for Android Client</a></li>
          <li>16 March 2016 - <a href="blog/2016/03/16/hawkular-metrics-roadmap.html">Hawkular Metrics - Roadmap</a></li>
          <li>15 March 2016 - <a href="blog/2016/03/15/hawkular-1.0.0.Alpha11-released.html">The eleventh milestone of Hawkular released</a></li>
          <li>02 March 2016 - <a href="blog/2016/03/02/hawkular-metrics-0.13.0.Final-released.html">Hawkular Metrics 0.13.0 - Release</a></li>
          <li>23 February 2016 - <a href="blog/2016/02/22/hawkular-manage-iq.html">Integration with ManageIQ</a></li>
          <li>02 February 2016 - <a href="blog/2016/02/02/hawkular-metrics-0.12.0.Final-released.html">Hawkular Metrics 0.12.0 - Release</a></li>
          <li>25 January 2016 - <a href="blog/2016/01/25/hawkular-btm-apm.html">Hawkular-BTM now includes Application Performance Management</a></li>
          <li>21 January 2016 - <a href="blog/2016/01/21/hawkular-1.0.0.Alpha9-released.html">The nineth milestone of Hawkular released</a></li>
          <li>21 January 2016 - <a href="blog/2016/01/21/hawkular-command-gateway-clients.html">Hawkular Command Gateway Clients</a></li>
          <li>20 January 2016 - <a href="blog/2016/01/20/hawkular-datamining-demo-hwk-alpha9.html">Hawkular Data Mining - Predictive Charts</a></li>
          <li>12 January 2016 - <a href="blog/2016/01/12/hawkular-metrics-0.11.0.Final-released.html">Hawkular Metrics 0.11.0 - Release</a></li>
          <li>05 January 2016 - <a href="blog/2016/01/05/we-are-hiring.html">We are hiring !</a></li>
          <li>16 December 2015 - <a href="blog/2015/12/16/hawkular-1.0.0.Alpha8-released.html">The eigth milestone of Hawkular released</a></li>
          <li>01 December 2015 - <a href="blog/2015/12/01/hawkular-btm-instrument-docker-image.html">BTM: Instrumenting an application running from a docker image</a></li>
          <li>30 November 2015 - <a href="blog/2015/11/30/hawkular-btm-0-6-0-released.html">Monitoring Business Transactions in JBoss Ticket Monster App (Part 2)</a></li>
          <li>19 November 2015 - <a href="blog/2015/11/19/hawkular-1.0.0.Alpha7-released.html">Yet another release of Hawkular, the seventh one !</a></li>
          <li>10 November 2015 - <a href="blog/2015/11/10/hawkular-btm-0-5-0-released.html">Monitoring Business Transactions in JBoss Ticket Monster App</a></li>
          <li>30 October 2015 - <a href="blog/2015/10/30/hawkular-metrics-0.8.0.Final-released.html">Hawkular Metrics 0.9.0 - Release</a></li>
          <li>30 October 2015 - <a href="blog/2015/11/30/hawkular-metrics-0.10.0.Final-released.html">Hawkular Metrics 0.10.0 - Release</a></li>
          <li>24 October 2015 - <a href="blog/2015/10/24/hawkular-datamining.html">Introduction to Hawkular Data Mining Module</a></li>
          <li>21 October 2015 - <a href="blog/2015/10/21/hawkular-1.0.0.Alpha6-released.html">The sixth milestone of Hawkular released</a></li>
          <li>12 October 2015 - <a href="blog/2015/10/12/hawkular-metrics-0.8.0.Final-released.html">Hawkular Metrics 0.8.0 - Release</a></li>
          <li>09 October 2015 - <a href="blog/2015/10/09/graph-db-performance.html">Titan Graph DB Performance Tips</a></li>
          <li>06 October 2015 - <a href="blog/2015/10/06/hawkular-btm-0-4-0-released.html">Hawkular-BTM 0.4.0 released</a></li>
          <li>05 October 2015 - <a href="blog/2015/10/05/hawkular-metrics-2k-commits.html">Hawkular Metrics - 2k Commits</a></li>
          <li>30 September 2015 - <a href="blog/2015/09/30/hawkular-metrics-0.7.0.Final-released.html">Hawkular Metrics 0.7.0 - Release</a></li>
          <li>23 September 2015 - <a href="blog/2015/09/23/hawkular-1.0.0.Alpha5-released.html">The fifth milestone of Hawkular released</a></li>
          <li>03 September 2015 - <a href="blog/2015/09/03/monitoring-rails-using-hawkular-metrics.html">Monitoring Rails App using Hawkular Metrics</a></li>
          <li>29 August 2015 - <a href="blog/2015/08/29/hawkular-metrics-0.6.0.Final-released.html">Hawkular Metrics 0.6.0 - Release</a></li>
          <li>27 August 2015 - <a href="blog/2015/08/27/hawkular-1.0.0.Alpha4-released.html">The fourth milestone of Hawkular released</a></li>
          <li>25 August 2015 - <a href="blog/2015/08/25/hawkular-alerts-autoresolve.html">Introduction to AutoResolve triggers</a></li>
          <li>19 August 2015 - <a href="blog/2015/08/19/hawkular-alerts-standalone.html">Using Hawkular Alerts as a standalone engine</a></li>
          <li>14 August 2015 - <a href="blog/2015/08/14/hawkular-btm-0.3.0-demo.html">Visualising Business Transaction Information using Hawkular BTM 0.3.0.Final with RTGov Integration</a></li>
          <li>30 July 2015 - <a href="blog/2015/07/30/hawkular-1.0.0.Alpha3-released.html">Hawkular, all good things make three!</a></li>
          <li>22 July 2015 - <a href="blog/2015/07/22/hawkular-btm-0.2.0-demo.html">Monitoring a Vert.x Application using Hawkular BTM 0.2.0.Final</a></li>
          <li>02 July 2015 - <a href="blog/2015/07/02/hawkular-1.0.0.Alpha2-released.html">Hawkular, the second release!</a></li>
          <li>01 July 2015 - <a href="blog/2015/07/01/hawkular-btm-0-1-0-released.html">Hawkular-BTM 0.1.0 released</a></li>
          <li>01 July 2015 - <a href="blog/2015/07/01/hawkular-btm-0.1.0-demo.html">Monitoring a SwitchYard Application using Hawkular BTM 0.1.0.Final</a></li>
          <li>22 June 2015 - <a href="blog/2015/06/23/hawkular-metrics-0-4-0-released.html">Hawkular Metrics 0.4.0 - Release</a></li>
          <li>17 June 2015 - <a href="blog/2015/06/17/marsjug-and-rivieradev-retrospective.html">MarsJUG and RivieraDEV retrospective</a></li>
          <li>04 June 2015 - <a href="blog/2015/06/04/hawkular-1.0.0.Alpha1-released.html">Hawkular, the first release!</a></li>
          <li>01 June 2015 - <a href="blog/2015/06/01/hawkular-metrics-0-3-4-released.html">Hawkular Metrics 0.3.4 - Release</a></li>
          <li>30 April 2015 - <a href="blog/2015/04/30/introducing-btm.html">Introducing the latest Hawkular component: Business Transaction Management</a></li>
          <li>29 April 2015 - <a href="blog/2015/04/29/hello-to-gsoc-students.html">Hello GSoC Students</a></li>
          <li>17 April 2015 - <a href="blog/2015/04/14/intro-to-hawkular.html">Intro to Hawkular, a middleware open-source management solution</a></li>
          <li>14 April 2015 - <a href="blog/2015/04/14/hawkular-monitor-agent-intro.html">Hawkular-Monitor Agent</a></li>
          <li>09 April 2015 - <a href="blog/2015/04/09/alert-notifiers-for-mobile-devices.html">Alert notifiers for mobile devices</a></li>
          <li>08 April 2015 - <a href="blog/2015/2015-04-08-1.html">Testing collectd integration</a></li>
          <li>07 April 2015 - <a href="blog/2015/2015-04-07-1.html">Hawkular Metrics 0.3.1 - Release</a></li>
          <li>01 April 2015 - <a href="blog/2015/2015-04-01-1.html">Hawkular Discontinued</a></li>
          <li>30 March 2015 - <a href="blog/2015/2015-03-30-1.html">Dockerized Hawkular builds available</a></li>
          <li>24 February 2015 - <a href="blog/2015/2015-02-24-1.html">The Kettle starts boiling</a></li>
          <li>16 February 2015 - <a href="blog/2015/2015-02-16-1.html">Hawkular Metrics 0.2.7 - Release</a></li>
        <br/><br/>
    </div>

    <a href=feed.xml><i class="fa fa-rss"></i> RSS Feed</a>
</div>


		</div>
		<div id="push"></div>
    </div>

    <section class="redhat clearfix">
      <div class="container">
        <p class="pull-left">
          <a href="http://www.redhat.com/">
            <img alt="redhatlogo-white" src="/img/redhatlogo-white.png" width="130">
          </a>
        </p>
        <p class="muted credit pull-right">
				  &copy; 2016 | Hawkular is released under <a href="/license.html">Apache License v2.0</a>
					<a href="https://twitter.com/hawkular_org" class="twitter-follow-button" data-show-count="false" data-size="medium">Follow @hawkular_org</a>
				  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
					<iframe src="https://ghbtns.com/github-btn.html?user=hawkular&repo=hawkular-services&type=star" frameborder="0" scrolling="0" class="github-stars-btn"></iframe>
				</p>

    <!--p id="forkongithubp"><span id="forkongithub">
      <a href="https://github.com/hawkular" class="bg-grey">
        Fork me on GitHub
      </a>
    </span></p-->
      </div>
    </section>

    <!-- javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <!-- js -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
    <script src="js/jbossorg-tabzilla.js"></script>
    <script src="js/behavior.js"></script>
    <script src="js/prettify.js"></script>
    <script src="js//ekko-lightbox.min.js"></script>

<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'hawkular';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-61728352-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
